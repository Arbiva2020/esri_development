{"version":3,"names":["tableRowCss","TableRow","this","rowCells","emitTableRowFocusRequest","cellPosition","rowPosition","destination","lastCell","calciteInternalTableRowFocusRequest","emit","updateCells","slottedCells","tableRowSlotEl","assignedElements","flatten","filter","el","matches","renderedCells","Array","from","tableRowEl","querySelectorAll","numberCell","selectionCell","cells","concat","length","forEach","cell","index","positionInRow","parentRowType","rowType","scale","nodeName","readCellContentsToAT","disabled","parentRowIsSelected","selected","cellCount","handleSelectionOfRow","calciteTableRowSelect","handleKeyboardSelection","event","isActivationKey","key","preventDefault","handleCellChanges","handleDelayedCellChanges","requestAnimationFrame","componentDidLoad","connectedCallback","connectInteractive","componentDidRender","updateHostInteraction","disconnectedCallback","disconnectInteractive","calciteInternalTableRowFocusChangeHandler","target","contains","position","detail","positionAll","deflectDirection","find","_","setFocus","keyDownHandler","isControl","ctrlKey","focusElementInGroup","renderSelectionIcon","icon","selectionMode","h","getIconScale","renderSelectableCell","alignment","bodyRowCount","onClick","onKeyDown","selectedRowCount","selectedRowCountLocalized","parentRowPositionLocalized","positionSectionLocalized","renderNumberedCell","render","Host","ref","numbered","onSlotchange"],"sources":["src/components/table-row/table-row.scss?tag=calcite-table-row&encapsulation=shadow","src/components/table-row/table-row.tsx"],"sourcesContent":["/**\n * CSS Custom Properties\n *\n * These properties can be overridden using the component's tag as selector.\n *\n * @prop --calcite-table-row-background: Specifies the background color of the component.\n * @prop --calcite-table-row-border-color: Specifies the border color of the component.\n */\n\n:host {\n  --calcite-internal-table-row-background: var(--calcite-table-row-background, var(--calcite-color-foreground-1));\n  --calcite-internal-table-row-border-color: var(--calcite-table-row-border-color, transparent);\n  @apply contents;\n}\n\n@include base-component();\n\n@include disabled() {\n  tr {\n    @apply opacity-disabled pointer-events-none;\n  }\n}\n\ntr {\n  border-block-end: 1px solid var(--calcite-internal-table-row-border-color);\n  background-color: var(--calcite-internal-table-row-background);\n}\n","import {\n  Component,\n  Element,\n  Event,\n  EventEmitter,\n  h,\n  Host,\n  Listen,\n  Prop,\n  State,\n  VNode,\n  Watch,\n} from \"@stencil/core\";\nimport { LocalizedComponent } from \"../../utils/locale\";\nimport { Scale, SelectionMode } from \"../interfaces\";\nimport { focusElementInGroup, FocusElementInGroupDestination } from \"../../utils/dom\";\nimport { RowType, TableRowFocusEvent } from \"../table/interfaces\";\nimport { isActivationKey } from \"../../utils/key\";\nimport {\n  connectInteractive,\n  disconnectInteractive,\n  InteractiveComponent,\n  updateHostInteraction,\n} from \"../../utils/interactive\";\nimport { getIconScale } from \"../../utils/component\";\n\n/**\n * @slot - A slot for adding `calcite-table-cell` or `calcite-table-header` elements.\n */\n\n@Component({\n  tag: \"calcite-table-row\",\n  styleUrl: \"table-row.scss\",\n  shadow: true,\n})\nexport class TableRow implements InteractiveComponent, LocalizedComponent {\n  //--------------------------------------------------------------------------\n  //\n  //  Properties\n  //\n  //--------------------------------------------------------------------------\n\n  /** When `true`, interaction is prevented and the component is displayed with lower opacity. */\n  @Prop({ reflect: true }) disabled = false;\n\n  /** When `true`, the component is selected. */\n  @Prop({ reflect: true }) selected = false;\n\n  /** @internal */\n  @Prop({ mutable: true }) cellCount: number;\n\n  /** @internal */\n  @Prop() rowType: RowType;\n\n  /** @internal */\n  @Prop() numbered = false;\n\n  /** @internal */\n  @Prop() positionSection: number;\n\n  /** @internal */\n  @Prop() positionSectionLocalized: string;\n\n  /** @internal */\n  @Prop() positionAll: number;\n\n  /** @internal */\n  @Prop() readCellContentsToAT: boolean;\n\n  /** @internal */\n  @Prop() scale: Scale;\n\n  /** @internal */\n  @Prop() selectionMode: Extract<\"multiple\" | \"single\" | \"none\", SelectionMode> = \"none\";\n\n  /** @internal */\n  @Prop() selectedRowCount: number;\n\n  /** @internal */\n  @Prop() selectedRowCountLocalized: string;\n\n  /** @internal */\n  @Prop() bodyRowCount: number;\n\n  @Watch(\"bodyRowCount\")\n  @Watch(\"scale\")\n  @Watch(\"selected\")\n  @Watch(\"selectedRowCount\")\n  handleCellChanges(): void {\n    if (this.tableRowEl && this.rowCells.length > 0) {\n      this.updateCells();\n    }\n  }\n\n  @Watch(\"numbered\")\n  @Watch(\"selectionMode\")\n  handleDelayedCellChanges(): void {\n    if (this.tableRowEl && this.rowCells.length > 0) {\n      requestAnimationFrame(() => this.updateCells());\n    }\n  }\n\n  //--------------------------------------------------------------------------\n  //\n  //  Lifecycle\n  //\n  //--------------------------------------------------------------------------\n\n  componentDidLoad(): void {\n    if (this.tableRowEl && this.rowCells.length > 0) {\n      this.updateCells();\n    }\n  }\n\n  connectedCallback(): void {\n    connectInteractive(this);\n  }\n\n  componentDidRender(): void {\n    updateHostInteraction(this);\n  }\n\n  disconnectedCallback(): void {\n    disconnectInteractive(this);\n  }\n\n  //--------------------------------------------------------------------------\n  //\n  //  Private Properties\n  //\n  //--------------------------------------------------------------------------\n\n  @Element() el: HTMLCalciteTableRowElement;\n\n  private rowCells: (HTMLCalciteTableCellElement | HTMLCalciteTableHeaderElement)[] = [];\n\n  private tableRowEl: HTMLTableRowElement;\n\n  private tableRowSlotEl: HTMLSlotElement;\n\n  @State() effectiveLocale = \"\";\n\n  // --------------------------------------------------------------------------\n  //\n  //  Events\n  //\n  // --------------------------------------------------------------------------\n\n  /**\n   * Fires when the selected state of the component changes.\n   */\n  @Event({ cancelable: false }) calciteTableRowSelect: EventEmitter<void>;\n\n  /** @internal */\n  @Event({ cancelable: false })\n  calciteInternalTableRowFocusRequest: EventEmitter<TableRowFocusEvent>;\n\n  //--------------------------------------------------------------------------\n  //\n  //  Event Listeners\n  //\n  //--------------------------------------------------------------------------\n\n  @Listen(\"calciteInternalTableRowFocusChange\", { target: \"document\" })\n  calciteInternalTableRowFocusChangeHandler(event: CustomEvent): void {\n    if ((event.target as Element).contains(this.el)) {\n      const position = event.detail.cellPosition;\n      const rowPosition = event.detail.rowPosition;\n      const destination = event.detail.destination;\n      const lastCell = event.detail.lastCell;\n\n      if (rowPosition === this.positionAll) {\n        if (this.disabled) {\n          const deflectDirection =\n            destination === \"last\" ? \"previous\" : destination === \"first\" ? \"next\" : destination;\n          this.emitTableRowFocusRequest(position, this.positionAll, deflectDirection);\n          return;\n        }\n        const cellPosition = lastCell\n          ? this.rowCells[this.rowCells.length - 1]\n          : this.rowCells?.find((_, index) => index + 1 === position);\n\n        if (cellPosition) {\n          cellPosition.setFocus();\n        }\n      }\n    }\n  }\n\n  //--------------------------------------------------------------------------\n  //\n  //  Private Methods\n  //\n  //--------------------------------------------------------------------------\n\n  private keyDownHandler(event: KeyboardEvent): void {\n    const el = event.target as HTMLCalciteTableCellElement | HTMLCalciteTableHeaderElement;\n    const key = event.key;\n    const isControl = event.ctrlKey;\n    const cells = this.rowCells;\n    if (el.matches(\"calcite-table-cell\") || el.matches(\"calcite-table-header\")) {\n      switch (key) {\n        case \"ArrowUp\":\n          this.emitTableRowFocusRequest(el.positionInRow, this.positionAll, \"previous\");\n          event.preventDefault();\n          break;\n        case \"ArrowDown\":\n          this.emitTableRowFocusRequest(el.positionInRow, this.positionAll, \"next\");\n          event.preventDefault();\n          break;\n        case \"PageUp\":\n          this.emitTableRowFocusRequest(el.positionInRow, this.positionAll, \"first\");\n          event.preventDefault();\n          break;\n        case \"PageDown\":\n          this.emitTableRowFocusRequest(el.positionInRow, this.positionAll, \"last\");\n          event.preventDefault();\n          break;\n        case \"ArrowLeft\":\n          focusElementInGroup(cells, el, \"previous\", false);\n          event.preventDefault();\n          break;\n        case \"ArrowRight\":\n          focusElementInGroup(cells, el, \"next\", false);\n          event.preventDefault();\n          break;\n        case \"Home\":\n          if (isControl) {\n            this.emitTableRowFocusRequest(1, this.positionAll, \"first\");\n            event.preventDefault();\n          } else {\n            focusElementInGroup(cells, el, \"first\", false);\n            event.preventDefault();\n          }\n          break;\n        case \"End\":\n          if (isControl) {\n            this.emitTableRowFocusRequest(this.rowCells?.length, this.positionAll, \"last\", true);\n            event.preventDefault();\n          } else {\n            focusElementInGroup(cells, el, \"last\", false);\n            event.preventDefault();\n          }\n          break;\n      }\n    }\n  }\n\n  private emitTableRowFocusRequest = (\n    cellPosition: number,\n    rowPosition: number,\n    destination: FocusElementInGroupDestination,\n    lastCell?: boolean\n  ): void => {\n    this.calciteInternalTableRowFocusRequest.emit({\n      cellPosition,\n      rowPosition,\n      destination,\n      lastCell,\n    });\n  };\n\n  private updateCells = (): void => {\n    const slottedCells = this.tableRowSlotEl\n      ?.assignedElements({ flatten: true })\n      ?.filter(\n        (el: HTMLCalciteTableCellElement | HTMLCalciteTableHeaderElement) =>\n          el.matches(\"calcite-table-cell\") || el.matches(\"calcite-table-header\")\n      );\n\n    const renderedCells = Array.from(\n      this.tableRowEl?.querySelectorAll(\"calcite-table-header, calcite-table-cell\")\n    )?.filter(\n      (el: HTMLCalciteTableCellElement | HTMLCalciteTableHeaderElement) =>\n        el.numberCell || el.selectionCell\n    );\n\n    const cells = renderedCells ? renderedCells.concat(slottedCells) : slottedCells;\n\n    if (cells.length > 0) {\n      cells?.forEach((cell: HTMLCalciteTableCellElement | HTMLCalciteTableHeaderElement, index) => {\n        cell.positionInRow = index + 1;\n        cell.parentRowType = this.rowType;\n        cell.scale = this.scale;\n\n        if (cell.nodeName === \"CALCITE-TABLE-CELL\") {\n          (cell as HTMLCalciteTableCellElement).readCellContentsToAT = this.readCellContentsToAT;\n          (cell as HTMLCalciteTableCellElement).disabled = this.disabled;\n          (cell as HTMLCalciteTableCellElement).parentRowIsSelected = this.selected;\n        }\n      });\n    }\n\n    this.rowCells =\n      (cells as (HTMLCalciteTableCellElement | HTMLCalciteTableHeaderElement)[]) || [];\n    this.cellCount = cells?.length;\n  };\n\n  private handleSelectionOfRow = (): void => {\n    this.calciteTableRowSelect.emit();\n  };\n\n  private handleKeyboardSelection = (event: KeyboardEvent): void => {\n    if (isActivationKey(event.key)) {\n      if (event.key === \" \") {\n        event.preventDefault();\n      }\n      this.handleSelectionOfRow();\n    }\n  };\n\n  //--------------------------------------------------------------------------\n  //\n  //  Render Methods\n  //\n  //--------------------------------------------------------------------------\n\n  renderSelectionIcon(): VNode {\n    const icon =\n      this.selectionMode === \"multiple\" && this.selected\n        ? \"check-square-f\"\n        : this.selectionMode === \"multiple\"\n        ? \"square\"\n        : this.selected\n        ? \"circle-f\"\n        : \"circle\";\n\n    return <calcite-icon icon={icon} scale={getIconScale(this.scale)} />;\n  }\n\n  renderSelectableCell(): VNode {\n    return this.rowType === \"head\" ? (\n      <calcite-table-header\n        alignment=\"center\"\n        bodyRowCount={this.bodyRowCount}\n        key=\"selection-head\"\n        onClick={this.selectionMode === \"multiple\" && this.handleSelectionOfRow}\n        onKeyDown={this.selectionMode === \"multiple\" && this.handleKeyboardSelection}\n        selectedRowCount={this.selectedRowCount}\n        selectedRowCountLocalized={this.selectedRowCountLocalized}\n        selectionCell={true}\n        selectionMode={this.selectionMode}\n      />\n    ) : this.rowType === \"body\" ? (\n      <calcite-table-cell\n        alignment=\"center\"\n        key=\"selection-body\"\n        onClick={this.handleSelectionOfRow}\n        onKeyDown={this.handleKeyboardSelection}\n        parentRowIsSelected={this.selected}\n        parentRowPositionLocalized={this.positionSectionLocalized}\n        selectionCell={true}\n      >\n        {this.renderSelectionIcon()}\n      </calcite-table-cell>\n    ) : (\n      <calcite-table-cell alignment=\"center\" key=\"selection-foot\" selectionCell={true} />\n    );\n  }\n\n  renderNumberedCell(): VNode {\n    return this.rowType === \"head\" ? (\n      <calcite-table-header alignment=\"center\" key=\"numbered-head\" numberCell={true} />\n    ) : this.rowType === \"body\" ? (\n      <calcite-table-cell alignment=\"center\" key=\"numbered-body\" numberCell={true}>\n        {this.positionSectionLocalized}\n      </calcite-table-cell>\n    ) : (\n      <calcite-table-cell alignment=\"center\" key=\"numbered-foot\" numberCell={true} />\n    );\n  }\n\n  render(): VNode {\n    return (\n      <Host>\n        <tr\n          aria-disabled={this.disabled}\n          aria-rowindex={this.positionAll + 1}\n          aria-selected={this.selected}\n          onKeyDown={(event) => this.keyDownHandler(event)}\n          // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)\n          ref={(el) => (this.tableRowEl = el)}\n        >\n          {this.numbered && this.renderNumberedCell()}\n          {this.selectionMode !== \"none\" && this.renderSelectableCell()}\n          <slot\n            onSlotchange={this.updateCells}\n            ref={(el) => (this.tableRowSlotEl = el as HTMLSlotElement)}\n          />\n        </tr>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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"}