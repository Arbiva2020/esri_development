{"version":3,"names":["CSS","container","searchIcon","ICONS","search","close","DEBOUNCE_TIMEOUT","filterCss","Filter","this","filterDebounced","debounce","value","emit","onFilter","updateFiltered","filter","items","inputHandler","event","target","keyDownHandler","key","clear","preventDefault","setFocus","watchItemsHandler","onMessagesChange","valueHandler","effectiveLocaleChange","updateMessages","effectiveLocale","componentWillLoad","setUpLoadableComponent","setUpMessages","connectedCallback","connectInteractive","connectLocalized","connectMessages","componentDidRender","updateHostInteraction","disconnectedCallback","disconnectInteractive","disconnectLocalized","disconnectMessages","cancel","componentDidLoad","setComponentLoaded","Promise","resolve","componentFocusable","el","focus","filtered","callback","filteredItems","calciteFilterChange","render","disabled","scale","h","Fragment","class","clearable","icon","label","messages","messageOverrides","onCalciteInputInput","onKeyDown","placeholder","type","ref","textInput"],"sources":["src/components/filter/resources.ts","src/components/filter/filter.scss?tag=calcite-filter&encapsulation=shadow","src/components/filter/filter.tsx"],"sourcesContent":["export const CSS = {\n  container: \"container\",\n  searchIcon: \"search-icon\",\n};\n\nexport const ICONS = {\n  search: \"search\",\n  close: \"x\",\n};\n\nexport const DEBOUNCE_TIMEOUT = 250;\n",":host {\n  @extend %component-host;\n  @apply flex w-full;\n}\n\n@include disabled();\n\n.container {\n  @apply flex w-full p-2;\n}\n\nlabel {\n  @apply relative\n    mx-1\n    my-0\n    flex w-full\n    items-center\n    overflow-hidden;\n}\n\ninput[type=\"text\"] {\n  @apply font-inherit\n    text-color-1\n    text-n2h\n    mb-1\n    w-full\n    border-none\n    bg-transparent\n    py-1;\n  padding-inline-end: theme(\"spacing.1\");\n  padding-inline-start: theme(\"spacing.6\");\n  transition: padding var(--calcite-animation-timing), box-shadow var(--calcite-animation-timing);\n  &::-ms-clear {\n    @apply hidden;\n  }\n}\n\ncalcite-input {\n  @apply w-full;\n}\n\n.search-icon {\n  @apply text-color-2\n    absolute\n    flex;\n  inset-inline-start: 0;\n  transition: inset-inline-start var(--calcite-animation-timing), inset-inline-end var(--calcite-animation-timing),\n    opacity var(--calcite-animation-timing);\n}\n\ninput[type=\"text\"]:focus {\n  @apply border-color-brand outline-none;\n  padding-inline: theme(\"padding.1\");\n  & ~ .search-icon {\n    inset-inline-start: calc(theme(\"spacing.4\") * -1);\n    @apply opacity-0;\n  }\n}\n\n.clear-button {\n  @apply text-color-2\n    flex\n    cursor-pointer\n    items-center\n    border-0\n    bg-transparent;\n  &:hover,\n  &:focus {\n    @apply text-color-1;\n  }\n}\n\n@include base-component();\n","import {\n  Component,\n  Element,\n  Event,\n  EventEmitter,\n  Fragment,\n  h,\n  Method,\n  Prop,\n  State,\n  VNode,\n  Watch,\n} from \"@stencil/core\";\nimport { debounce } from \"lodash-es\";\nimport { filter } from \"../../utils/filter\";\nimport {\n  connectInteractive,\n  disconnectInteractive,\n  InteractiveComponent,\n  updateHostInteraction,\n} from \"../../utils/interactive\";\nimport {\n  componentFocusable,\n  LoadableComponent,\n  setComponentLoaded,\n  setUpLoadableComponent,\n} from \"../../utils/loadable\";\nimport { connectLocalized, disconnectLocalized, LocalizedComponent } from \"../../utils/locale\";\nimport {\n  connectMessages,\n  disconnectMessages,\n  setUpMessages,\n  T9nComponent,\n  updateMessages,\n} from \"../../utils/t9n\";\nimport { Scale } from \"../interfaces\";\nimport { FilterMessages } from \"./assets/filter/t9n\";\nimport { CSS, DEBOUNCE_TIMEOUT, ICONS } from \"./resources\";\n\n@Component({\n  tag: \"calcite-filter\",\n  styleUrl: \"filter.scss\",\n  shadow: {\n    delegatesFocus: true,\n  },\n  assetsDirs: [\"assets\"],\n})\nexport class Filter\n  implements InteractiveComponent, LoadableComponent, LocalizedComponent, T9nComponent\n{\n  // --------------------------------------------------------------------------\n  //\n  //  Properties\n  //\n  // --------------------------------------------------------------------------\n\n  /**\n   * Defines the items to filter. The component uses the values as the starting point, and returns items\n   *\n   * that contain the string entered in the input, using a partial match and recursive search.\n   *\n   * This property is needed to conduct filtering.\n   *\n   */\n  @Prop() items: object[] = [];\n\n  @Watch(\"items\")\n  watchItemsHandler(): void {\n    this.filterDebounced(this.value);\n  }\n\n  /**\n   * When `true`, interaction is prevented and the component is displayed with lower opacity.\n   */\n  @Prop({ reflect: true }) disabled = false;\n\n  /**\n   * The component's resulting items after filtering.\n   *\n   * @readonly\n   */\n  @Prop({ mutable: true }) filteredItems: object[] = [];\n\n  /**\n   * Specifies placeholder text for the input element.\n   */\n  @Prop() placeholder: string;\n\n  /**\n   * Specifies the size of the component.\n   */\n  @Prop({ reflect: true }) scale: Scale = \"m\";\n\n  /**\n   * The component's value.\n   */\n  @Prop({ mutable: true }) value = \"\";\n\n  /**\n   * Made into a prop for testing purposes only\n   *\n   * @internal\n   */\n  // eslint-disable-next-line @stencil-community/strict-mutable -- updated by t9n module\n  @Prop({ mutable: true }) messages: FilterMessages;\n\n  /**\n   * Use this property to override individual strings used by the component.\n   */\n  // eslint-disable-next-line @stencil-community/strict-mutable -- updated by t9n module\n  @Prop({ mutable: true }) messageOverrides: Partial<FilterMessages>;\n\n  @Watch(\"messageOverrides\")\n  onMessagesChange(): void {\n    /* wired up by t9n util */\n  }\n\n  @Watch(\"value\")\n  valueHandler(value: string): void {\n    this.filterDebounced(value);\n  }\n\n  // --------------------------------------------------------------------------\n  //\n  //  Private State/Properties\n  //\n  // --------------------------------------------------------------------------\n\n  @Element() el: HTMLCalciteFilterElement;\n\n  textInput: HTMLCalciteInputElement;\n\n  @State() effectiveLocale: string;\n\n  @Watch(\"effectiveLocale\")\n  effectiveLocaleChange(): void {\n    updateMessages(this, this.effectiveLocale);\n  }\n\n  @State() defaultMessages: FilterMessages;\n\n  // --------------------------------------------------------------------------\n  //\n  //  Events\n  //\n  // --------------------------------------------------------------------------\n\n  /**\n   * This event fires when the filter text changes.\n   */\n  @Event({ cancelable: false }) calciteFilterChange: EventEmitter<void>;\n\n  //--------------------------------------------------------------------------\n  //\n  //  Lifecycle\n  //\n  //--------------------------------------------------------------------------\n\n  async componentWillLoad(): Promise<void> {\n    setUpLoadableComponent(this);\n    this.updateFiltered(filter(this.items, this.value));\n    await setUpMessages(this);\n  }\n\n  connectedCallback(): void {\n    connectInteractive(this);\n    connectLocalized(this);\n    connectMessages(this);\n  }\n\n  componentDidRender(): void {\n    updateHostInteraction(this);\n  }\n\n  disconnectedCallback(): void {\n    disconnectInteractive(this);\n    disconnectLocalized(this);\n    disconnectMessages(this);\n    this.filterDebounced.cancel();\n  }\n\n  componentDidLoad(): void {\n    setComponentLoaded(this);\n  }\n\n  // --------------------------------------------------------------------------\n  //\n  //  Public Methods\n  //\n  // --------------------------------------------------------------------------\n\n  /**\n   * Performs a filter on the component.\n   *\n   * This method can be useful because filtering is delayed and asynchronous.\n   *\n   * @param {string} value - The filter text value.\n   * @returns {Promise<void>}\n   */\n  @Method()\n  async filter(value: string = this.value): Promise<void> {\n    return new Promise((resolve) => {\n      this.value = value;\n      this.filterDebounced(value, false, resolve);\n    });\n  }\n\n  /** Sets focus on the component. */\n  @Method()\n  async setFocus(): Promise<void> {\n    await componentFocusable(this);\n\n    this.el?.focus();\n  }\n\n  // --------------------------------------------------------------------------\n  //\n  //  Private Methods\n  //\n  // --------------------------------------------------------------------------\n\n  private filterDebounced = debounce(\n    (value: string, emit = false, onFilter?: () => void): void =>\n      this.updateFiltered(filter(this.items, value), emit, onFilter),\n    DEBOUNCE_TIMEOUT\n  );\n\n  inputHandler = (event: CustomEvent): void => {\n    const target = event.target as HTMLCalciteInputElement;\n    this.value = target.value;\n    this.filterDebounced(target.value, true);\n  };\n\n  keyDownHandler = (event: KeyboardEvent): void => {\n    if (event.key === \"Escape\") {\n      this.clear();\n      event.preventDefault();\n    }\n\n    if (event.key === \"Enter\") {\n      event.preventDefault();\n    }\n  };\n\n  clear = (): void => {\n    this.value = \"\";\n    this.filterDebounced(\"\", true);\n    this.setFocus();\n  };\n\n  updateFiltered(filtered: object[], emit = false, callback?: () => void): void {\n    this.filteredItems = filtered;\n    if (emit) {\n      this.calciteFilterChange.emit();\n    }\n    callback?.();\n  }\n\n  // --------------------------------------------------------------------------\n  //\n  //  Render Methods\n  //\n  // --------------------------------------------------------------------------\n\n  render(): VNode {\n    const { disabled, scale } = this;\n\n    return (\n      <Fragment>\n        <div class={CSS.container}>\n          <label>\n            <calcite-input\n              clearable={true}\n              disabled={disabled}\n              icon={ICONS.search}\n              label={this.messages.label}\n              messageOverrides={{ clear: this.messages.clear }}\n              onCalciteInputInput={this.inputHandler}\n              onKeyDown={this.keyDownHandler}\n              placeholder={this.placeholder}\n              scale={scale}\n              type=\"text\"\n              value={this.value}\n              // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)\n              ref={(el): void => {\n                this.textInput = el;\n              }}\n            />\n          </label>\n        </div>\n      </Fragment>\n    );\n  }\n}\n"],"mappings":";;;;;geAAO,MAAMA,EAAM,CACjBC,UAAW,YACXC,WAAY,eAGP,MAAMC,EAAQ,CACnBC,OAAQ,SACRC,MAAO,KAGF,MAAMC,EAAmB,ICVhC,MAAMC,EAAY,02D,MC+CLC,EAAM,M,kFA8KTC,KAAAC,gBAAkBC,GACxB,CAACC,EAAeC,EAAO,MAAOC,IAC5BL,KAAKM,eAAeC,EAAOP,KAAKQ,MAAOL,GAAQC,EAAMC,IACvDR,GAGFG,KAAAS,aAAgBC,IACd,MAAMC,EAASD,EAAMC,OACrBX,KAAKG,MAAQQ,EAAOR,MACpBH,KAAKC,gBAAgBU,EAAOR,MAAO,KAAK,EAG1CH,KAAAY,eAAkBF,IAChB,GAAIA,EAAMG,MAAQ,SAAU,CAC1Bb,KAAKc,QACLJ,EAAMK,gB,CAGR,GAAIL,EAAMG,MAAQ,QAAS,CACzBH,EAAMK,gB,GAIVf,KAAAc,MAAQ,KACNd,KAAKG,MAAQ,GACbH,KAAKC,gBAAgB,GAAI,MACzBD,KAAKgB,UAAU,E,WAvLS,G,cAUU,M,mBAOe,G,sCAUX,I,WAKP,G,sHA7BjC,iBAAAC,GACEjB,KAAKC,gBAAgBD,KAAKG,M,CA6C5B,gBAAAe,G,CAKA,YAAAC,CAAahB,GACXH,KAAKC,gBAAgBE,E,CAgBvB,qBAAAiB,GACEC,EAAerB,KAAMA,KAAKsB,gB,CAsB5B,uBAAMC,GACJC,EAAuBxB,MACvBA,KAAKM,eAAeC,EAAOP,KAAKQ,MAAOR,KAAKG,cACtCsB,EAAczB,K,CAGtB,iBAAA0B,GACEC,EAAmB3B,MACnB4B,EAAiB5B,MACjB6B,EAAgB7B,K,CAGlB,kBAAA8B,GACEC,EAAsB/B,K,CAGxB,oBAAAgC,GACEC,EAAsBjC,MACtBkC,EAAoBlC,MACpBmC,EAAmBnC,MACnBA,KAAKC,gBAAgBmC,Q,CAGvB,gBAAAC,GACEC,EAAmBtC,K,CAkBrB,YAAMO,CAAOJ,EAAgBH,KAAKG,OAChC,OAAO,IAAIoC,SAASC,IAClBxC,KAAKG,MAAQA,EACbH,KAAKC,gBAAgBE,EAAO,MAAOqC,EAAQ,G,CAM/C,cAAMxB,SACEyB,EAAmBzC,MAEzBA,KAAK0C,IAAIC,O,CAsCX,cAAArC,CAAesC,EAAoBxC,EAAO,MAAOyC,GAC/C7C,KAAK8C,cAAgBF,EACrB,GAAIxC,EAAM,CACRJ,KAAK+C,oBAAoB3C,M,CAE3ByC,K,CASF,MAAAG,GACE,MAAMC,SAAEA,EAAQC,MAAEA,GAAUlD,KAE5B,OACEmD,EAACC,EAAQ,KACPD,EAAA,OAAKE,MAAO9D,EAAIC,WACd2D,EAAA,aACEA,EAAA,iBACEG,UAAW,KACXL,SAAUA,EACVM,KAAM7D,EAAMC,OACZ6D,MAAOxD,KAAKyD,SAASD,MACrBE,iBAAkB,CAAE5C,MAAOd,KAAKyD,SAAS3C,OACzC6C,oBAAqB3D,KAAKS,aAC1BmD,UAAW5D,KAAKY,eAChBiD,YAAa7D,KAAK6D,YAClBX,MAAOA,EACPY,KAAK,OACL3D,MAAOH,KAAKG,MAEZ4D,IAAMrB,IACJ1C,KAAKgE,UAAYtB,CAAE,M"}