"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-node_modules_arcgis_core_layers_mixins_ArcGISService_js-node_modules_arcgis_core_laye-8dc12f"],{

/***/ "./node_modules/@arcgis/core/core/ByteSizeUnit.js":
/*!********************************************************!*\
  !*** ./node_modules/@arcgis/core/core/ByteSizeUnit.js ***!
  \********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ByteSizeUnit": () => (/* binding */ E)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
var E;!function(E){E[E.KILOBYTES=1024]="KILOBYTES",E[E.MEGABYTES=1048576]="MEGABYTES",E[E.GIGABYTES=1073741824]="GIGABYTES"}(E||(E={}));


/***/ }),

/***/ "./node_modules/@arcgis/core/core/LRUCache.js":
/*!****************************************************!*\
  !*** ./node_modules/@arcgis/core/core/LRUCache.js ***!
  \****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LRUCache": () => (/* binding */ e)
/* harmony export */ });
/* harmony import */ var _MemCache_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MemCache.js */ "./node_modules/@arcgis/core/core/MemCache.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
class e{constructor(e,s){this._storage=new _MemCache_js__WEBPACK_IMPORTED_MODULE_0__.MemCacheStorage,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),s&&this._storage.registerRemoveFunc("",s)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(t,e,s=1){this._storage.put(this,t,e,s,1)}pop(t){return this._storage.pop(this,t)}get(t){return this._storage.get(this,t)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}resetHitRate(){}}


/***/ }),

/***/ "./node_modules/@arcgis/core/core/MemCache.js":
/*!****************************************************!*\
  !*** ./node_modules/@arcgis/core/core/MemCache.js ***!
  \****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MIN_PRIORITY": () => (/* binding */ e),
/* harmony export */   "MemCache": () => (/* binding */ s),
/* harmony export */   "MemCacheStorage": () => (/* binding */ r),
/* harmony export */   "RemoveMode": () => (/* binding */ i)
/* harmony export */ });
/* harmony import */ var _PooledArray_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PooledArray.js */ "./node_modules/@arcgis/core/core/PooledArray.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
const e=-3;var i;!function(t){t[t.ALL=0]="ALL",t[t.SOME=1]="SOME"}(i||(i={}));class s{constructor(t,e,i){this.name=t,this._storage=e,this.id=h+++":",this.size=0,this.maxSize=0,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),i&&(this._storage.registerRemoveFunc(this.id,i),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get sizeAll(){return this._storage.size}resetHitRate(){this._hit=this._miss=0}put(t,e,i,s=0){this._storage.put(this,t,e,i,s)}get(t){const e=this._storage.get(this,t);return void 0===e?++this._miss:++this._hit,e}pop(t){const e=this._storage.pop(this,t);return void 0===e?++this._miss:++this._hit,e}updateSize(t,e,i){this._storage.updateSize(this,t,e,i)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class r{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new _PooledArray_js__WEBPACK_IMPORTED_MODULE_0__["default"],this._users=new _PooledArray_js__WEBPACK_IMPORTED_MODULE_0__["default"]}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,e){this._removeFuncs.push([t,e])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace((e=>e[0]!==t))}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,0),this._checkSizeLimits()}put(t,s,r,h,o){s=t.id+s;const n=this._db.get(s);if(n&&(this._size-=n.size,t.size-=n.size,this._db.delete(s),n.entry!==r&&this._notifyRemove(s,n.entry,i.ALL)),h>this._maxSize)return void this._notifyRemove(s,r,i.ALL);if(void 0===r)return void console.warn("Refusing to cache undefined entry ");if(!h||h<0)return void console.warn("Refusing to cache entry with invalid size "+h);const _=1+Math.max(o,e)-e;this._db.set(s,{entry:r,size:h,lifetime:_,lives:_}),this._size+=h,t.size+=h,this._checkSizeLimits()}updateSize(t,e,s,r){e=t.id+e;const h=this._db.get(e);if(h&&h.entry===s){for(this._size-=h.size,t.size-=h.size;r>this._maxSize;){const t=this._notifyRemove(e,s,i.SOME);if(!(null!=t&&t>0))return void this._db.delete(e);r=t}h.size=r,this._size+=r,t.size+=r,this._checkSizeLimits()}}pop(t,e){e=t.id+e;const i=this._db.get(e);if(i)return this._size-=i.size,t.size-=i.size,this._db.delete(e),++this._hit,i.entry;++this._miss}get(t,e){e=t.id+e;const i=this._db.get(e);if(void 0!==i)return this._db.delete(e),i.lives=i.lifetime,this._db.set(e,i),++this._hit,i.entry;++this._miss}get performanceInfo(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},i={},s=new Array;this._db.forEach(((t,e)=>{const r=t.lifetime;s[r]=(s[r]||0)+t.size,this._users.forAll((s=>{const{id:r,name:h}=s;if(e.startsWith(r)){const e=i[h]||0;i[h]=e+t.size}}))}));const r={};this._users.forAll((t=>{const e=t.name;if("hitRate"in t&&"number"==typeof t.hitRate&&!isNaN(t.hitRate)&&t.hitRate>0){const s=i[e]||0;i[e]=s,r[e]=Math.round(100*t.hitRate)+"%"}else r[e]="0%"}));const h=Object.keys(i);h.sort(((t,e)=>i[e]-i[t])),h.forEach((e=>t[e]=Math.round(i[e]/2**20)+"MB / "+r[e]));for(let o=s.length-1;o>=0;--o){const i=s[o];i&&(t["Priority "+(o+e-1)]=Math.round(i/this._size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll((t=>t.resetHitRate()))}clear(t){const e=t.id;this._db.forEach(((t,s)=>{s.startsWith(e)&&(this._size-=t.size,this._db.delete(s),this._notifyRemove(s,t.entry,i.ALL))})),t.size=0}clearAll(){this._db.forEach(((t,e)=>this._notifyRemove(e,t.entry,i.ALL))),this._users.forEach((t=>t.size=0)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,e,i){let s;return this._removeFuncs.some((r=>{if(t.startsWith(r[0])){const t=r[1](e,i);return"number"==typeof t&&(s=t),!0}return!1})),s}_checkSizeLimits(){if(this._size>this._maxSize)for(const[t,e]of this._db)if(this._purgeItem(t,e),this._size<=.9*this.maxSize)return;this._users.forEach((t=>{if(t.maxSize>0&&t.size>t.maxSize)for(const[e,i]of this._db)if(e.startsWith(t.id)&&(this._purgeItem(e,i,t),t.size<=.9*t.maxSize))return}))}_purgeItem(t,e,s=this._users.find((e=>t.startsWith(e.id)))){if(this._db.delete(t),e.lives<=1){this._size-=e.size,s&&(s.size-=e.size);const r=this._notifyRemove(t,e.entry,i.SOME);null!=r&&r>0&&(this._size+=r,s&&(s.size+=r),e.lives=e.lifetime,e.size=r,this._db.set(t,e))}else--e.lives,this._db.set(t,e)}}let h=0;


/***/ }),

/***/ "./node_modules/@arcgis/core/geometry/support/UintArray.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@arcgis/core/geometry/support/UintArray.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "newUintArray": () => (/* binding */ t),
/* harmony export */   "uintArrayFrom": () => (/* binding */ e),
/* harmony export */   "uintSubArray": () => (/* binding */ y)
/* harmony export */ });
/* harmony import */ var _core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/typedArrayUtil.js */ "./node_modules/@arcgis/core/core/typedArrayUtil.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
function t(n,t=!1){return n<=_core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_0__.NATIVE_ARRAY_MAX_SIZE?t?new Array(n).fill(0):new Array(n):new Uint32Array(n)}function e(t){return((0,_core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_0__.isArray)(t)?t.length:t.byteLength/8)<=_core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_0__.NATIVE_ARRAY_MAX_SIZE?Array.from(t):new Uint32Array(t)}function y(r,n,t){return Array.isArray(r)?r.slice(n,n+t):r.subarray(n,n+t)}


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/mixins/ArcGISService.js":
/*!******************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/mixins/ArcGISService.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ArcGISService": () => (/* binding */ l)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/accessorSupport/ensureType.js */ "./node_modules/@arcgis/core/core/accessorSupport/ensureType.js");
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/arrayUtils.js */ "./node_modules/@arcgis/core/core/arrayUtils.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _support_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../support/arcgisLayerUrl.js */ "./node_modules/@arcgis/core/layers/support/arcgisLayerUrl.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
const l=l=>{let p=class extends l{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const t=(0,_support_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_7__.parse)(this.url);if(null!=t&&t.title)return t.title}return this._get("title")||""}set title(t){this._set("title",t)}set url(t){this._set("url",(0,_support_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_7__.sanitizeUrl)(t,_core_Logger_js__WEBPACK_IMPORTED_MODULE_1__["default"].getLogger(this)))}};return (0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)()],p.prototype,"title",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({type:String})],p.prototype,"url",null),p=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.subclass)("esri.layers.mixins.ArcGISService")],p),p};


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/Tilemap.js":
/*!*************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/Tilemap.js ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Tilemap": () => (/* binding */ r),
/* harmony export */   "tilemapDefinitionId": () => (/* binding */ n)
/* harmony export */ });
/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../request.js */ "./node_modules/@arcgis/core/request.js");
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/arrayUtils.js */ "./node_modules/@arcgis/core/core/arrayUtils.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_lang_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/lang.js */ "./node_modules/@arcgis/core/core/lang.js");
/* harmony import */ var _core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/typedArrayUtil.js */ "./node_modules/@arcgis/core/core/typedArrayUtil.js");
/* harmony import */ var _geometry_support_UintArray_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../geometry/support/UintArray.js */ "./node_modules/@arcgis/core/geometry/support/UintArray.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
class r{constructor(t){this._validateJSON(t);const{location:i,data:e}=t;this.location=Object.freeze((0,_core_lang_js__WEBPACK_IMPORTED_MODULE_3__.clone)(i));const r=this.location.width,n=this.location.height;let s=!0,h=!0;const c=Math.ceil(r*n/32),m=(0,_geometry_support_UintArray_js__WEBPACK_IMPORTED_MODULE_5__.newUintArray)(c);let f=0;for(let a=0;a<e.length;a++){const t=a%32;e[a]?(h=!1,m[f]|=1<<t):s=!1,31===t&&++f}h?(this._availability="unavailable",this.byteSize=40):s?(this._availability="available",this.byteSize=40):(this._availability=m,this.byteSize=40+(0,_core_typedArrayUtil_js__WEBPACK_IMPORTED_MODULE_4__.estimateSize)(m))}getAvailability(t,i){if("unavailable"===this._availability||"available"===this._availability)return this._availability;const e=(t-this.location.top)*this.location.width+(i-this.location.left),a=e%32,o=e>>5,l=this._availability;return o<0||o>l.length?"unknown":l[o]&1<<a?"available":"unavailable"}static fromDefinition(a,o){const l=a.service.request||_request_js__WEBPACK_IMPORTED_MODULE_0__["default"],{row:n,col:h,width:c,height:m}=a,f={query:{f:"json"}};return o=o?{...f,...o}:f,l(s(a),o).then((t=>t.data)).catch((t=>{if(t&&t.details&&422===t.details.httpStatus)return{location:{top:n,left:h,width:c,height:m},valid:!0,data:(0,_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.constant)(c*m,0)};throw t})).then((t=>{if(t.location&&(t.location.top!==n||t.location.left!==h||t.location.width!==c||t.location.height!==m))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:n,left:h,width:c,height:m}});return r.fromJSON(t)}))}static fromJSON(t){return Object.freeze(new r(t))}_validateJSON(t){if(!t||!t.location)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("tilemap:missing-location","Location missing from tilemap response");if(!1===t.valid)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("tilemap:invalid","Tilemap response was marked as invalid");if(!t.data)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(t.data))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("tilemap:data-mismatch","Data must be an array of numbers");if(t.data.length!==t.location.width*t.location.height)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}}function n(t){return`${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}function s(t){let i;if(t.service.tileServers?.length){const e=t.service.tileServers;i=`${e&&e.length?e[t.row%e.length]:t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}else i=`${t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;const e=t.service.query;return e&&(i=`${i}?${e}`),i}


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/TilemapCache.js":
/*!******************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/TilemapCache.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TilemapCache": () => (/* binding */ T)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../request.js */ "./node_modules/@arcgis/core/request.js");
/* harmony import */ var _core_Accessor_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/Accessor.js */ "./node_modules/@arcgis/core/core/Accessor.js");
/* harmony import */ var _core_ByteSizeUnit_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/ByteSizeUnit.js */ "./node_modules/@arcgis/core/core/ByteSizeUnit.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_handleUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/handleUtils.js */ "./node_modules/@arcgis/core/core/handleUtils.js");
/* harmony import */ var _core_LRUCache_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/LRUCache.js */ "./node_modules/@arcgis/core/core/LRUCache.js");
/* harmony import */ var _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/PooledArray.js */ "./node_modules/@arcgis/core/core/PooledArray.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../core/reactiveUtils.js */ "./node_modules/@arcgis/core/core/reactiveUtils.js");
/* harmony import */ var _core_scheduling_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../core/scheduling.js */ "./node_modules/@arcgis/core/core/scheduling.js");
/* harmony import */ var _core_urlUtils_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../core/urlUtils.js */ "./node_modules/@arcgis/core/core/urlUtils.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../core/accessorSupport/ensureType.js */ "./node_modules/@arcgis/core/core/accessorSupport/ensureType.js");
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../core/arrayUtils.js */ "./node_modules/@arcgis/core/core/arrayUtils.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _TileKey_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./TileKey.js */ "./node_modules/@arcgis/core/layers/support/TileKey.js");
/* harmony import */ var _Tilemap_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Tilemap.js */ "./node_modules/@arcgis/core/layers/support/Tilemap.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
var w;let T=w=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_2__["default"]{constructor(e){super(e),this._pendingTilemapRequests={},this.request=_request_js__WEBPACK_IMPORTED_MODULE_1__["default"],this.size=32,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new _core_LRUCache_js__WEBPACK_IMPORTED_MODULE_6__.LRUCache(2*_core_ByteSizeUnit_js__WEBPACK_IMPORTED_MODULE_3__.ByteSizeUnit.MEGABYTES),this.addHandles([(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.watch)((()=>{const{layer:e}=this;return[e?.parsedUrl,e?.tileServers,e?.apiKey,e?.customParameters]}),(()=>this._initializeTilemapDefinition()),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.initial)])}get effectiveMinLOD(){return this.minLOD??this.layer.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}fetchTilemap(e,t,i,r){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return Promise.reject(new _core_Error_js__WEBPACK_IMPORTED_MODULE_4__["default"]("tilemap-cache:level-unavailable",`Level ${e} is unavailable in the service`));const l=this._tmpTilemapDefinition,o=this._tilemapFromCache(e,t,i,l);if(o)return Promise.resolve(o);const a=r&&r.signal;return r={...r,signal:null},new Promise(((e,t)=>{(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__.onAbort)(a,(()=>t((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__.createAbortError)())));const i=(0,_Tilemap_js__WEBPACK_IMPORTED_MODULE_18__.tilemapDefinitionId)(l);let s=this._pendingTilemapRequests[i];if(!s){s=_Tilemap_js__WEBPACK_IMPORTED_MODULE_18__.Tilemap.fromDefinition(l,r).then((e=>(this._tilemapCache.put(i,e,e.byteSize),e)));const e=()=>delete this._pendingTilemapRequests[i];this._pendingTilemapRequests[i]=s,s.then(e,e)}s.then(e,t)}))}getAvailability(e,t,i){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return"unavailable";const r=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return r?r.getAvailability(t,i):"unknown"}fetchAvailability(e,t,i,r){return!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD?Promise.reject(new _core_Error_js__WEBPACK_IMPORTED_MODULE_4__["default"]("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i})):this.fetchTilemap(e,t,i,r).catch((e=>e)).then((r=>{if(r instanceof _Tilemap_js__WEBPACK_IMPORTED_MODULE_18__.Tilemap){const l=r.getAvailability(t,i);if("unavailable"===l)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_4__["default"]("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i});return l}if((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__.isAbortError)(r))throw r;return"unknown"}))}fetchAvailabilityUpsample(e,t,i,r,s){r.level=e,r.row=t,r.col=i;const l=this.layer.tileInfo;l.updateTileInfo(r);const o=this.fetchAvailability(e,t,i,s).catch((e=>{if((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__.isAbortError)(e))throw e;if(l.upsampleTile(r))return this.fetchAvailabilityUpsample(r.level,r.row,r.col,r,s);throw e}));return this._fetchAvailabilityUpsamplePrefetch(r.id,e,t,i,s,o),o}async _fetchAvailabilityUpsamplePrefetch(e,t,i,r,s,o){if(!this._prefetchingEnabled||null==e)return;const a=`prefetch-${e}`;if(this.hasHandles(a))return;const n=new AbortController;o.then((()=>n.abort()),(()=>n.abort()));let c=!1;const h=(0,_core_handleUtils_js__WEBPACK_IMPORTED_MODULE_5__.makeHandle)((()=>{c||(c=!0,n.abort())}));if(this.addHandles(h,a),await (0,_core_scheduling_js__WEBPACK_IMPORTED_MODULE_10__.waitTicks)(10,n.signal).catch((()=>{})),c||(c=!0,this.removeHandles(a)),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__.isAborted)(n))return;const m=new _TileKey_js__WEBPACK_IMPORTED_MODULE_17__.TileKey(e,t,i,r),f={...s,signal:n.signal},v=this.layer.tileInfo;for(let l=0;w._prefetches.length<w._maxPrefetch&&v.upsampleTile(m);++l){const e=this.fetchAvailability(m.level,m.row,m.col,f);w._prefetches.push(e);const t=()=>{w._prefetches.removeUnordered(e)};e.then(t,t)}}_initializeTilemapDefinition(){if(!this.layer.parsedUrl)return;const{parsedUrl:e,apiKey:t,customParameters:i}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_11__.objectToQuery)({...e.query,...i,token:t??e.query?.token}),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(e,t,i,r){r.level=e,r.row=t-t%this.size,r.col=i-i%this.size;const s=(0,_Tilemap_js__WEBPACK_IMPORTED_MODULE_18__.tilemapDefinitionId)(r);return this._tilemapCache.get(s)}get test(){const e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:(t,i,r)=>!!e._tilemapFromCache(t,i,r,e._tmpTilemapDefinition)}}};T._maxPrefetch=4,T._prefetches=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_7__["default"]({initialSize:w._maxPrefetch}),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_12__.property)({constructOnly:!0})],T.prototype,"layer",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_12__.property)({constructOnly:!0})],T.prototype,"minLOD",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_12__.property)({constructOnly:!0})],T.prototype,"maxLOD",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_12__.property)({constructOnly:!0})],T.prototype,"request",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_12__.property)({constructOnly:!0})],T.prototype,"size",void 0),T=w=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_16__.subclass)("esri.layers.support.TilemapCache")],T);


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvNDIzY2ZmMTUxZmJkYWI1NTIyMjhkZGY4NzI0ZjkyN2YuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxhQUFhLHlHQUF5RyxTQUFTLEdBQTZCOzs7Ozs7Ozs7Ozs7Ozs7O0FDSmxLO0FBQ0E7QUFDQTtBQUNBO0FBQ2dELFFBQVEsaUJBQWlCLGtCQUFrQix5REFBQyxvSUFBb0ksVUFBVSx1REFBdUQsYUFBYSxnQ0FBZ0MsT0FBTyxpQ0FBaUMsT0FBTyxpQ0FBaUMsUUFBUSx5QkFBeUIsY0FBYyw2QkFBNkIsZUFBZSx3QkFBd0IsaUJBQXVDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDSnhqQjtBQUNBO0FBQ0E7QUFDQTtBQUNnQyxXQUFXLE1BQU0sYUFBYSxvQ0FBb0MsU0FBUyxHQUFHLFFBQVEsbUJBQW1CLHNOQUFzTixVQUFVLDBJQUEwSSxjQUFjLHdDQUF3QyxjQUFjLDBCQUEwQixlQUFlLHVCQUF1QixlQUFlLGdDQUFnQyxPQUFPLGtDQUFrQyw2Q0FBNkMsT0FBTyxrQ0FBa0MsNkNBQTZDLGtCQUFrQixxQ0FBcUMsUUFBUSwwQkFBMEIsV0FBVyx5QkFBeUIsc0JBQXNCLHFDQUFxQyxhQUFhLDRCQUE0QixRQUFRLFdBQVcsa0JBQWtCLHdCQUF3Qiw2RkFBNkYsdURBQUMsaUJBQWlCLHVEQUFDLENBQUMsVUFBVSw0RUFBNEUsWUFBWSxvQkFBb0IsY0FBYywrQkFBK0Isd0JBQXdCLDhCQUE4Qix3QkFBd0IsK0NBQStDLGNBQWMscUJBQXFCLGVBQWUsb0RBQW9ELGVBQWUsU0FBUyx3QkFBd0Isd0tBQXdLLDZFQUE2RSxvRkFBb0YsMEJBQTBCLGdCQUFnQixrQ0FBa0Msa0RBQWtELG9CQUFvQixTQUFTLHdCQUF3QixtQkFBbUIsc0NBQXNDLGdCQUFnQixFQUFFLHVDQUF1QyxrREFBa0QsSUFBSSwwREFBMEQsU0FBUyxTQUFTLHdCQUF3QixxRkFBcUYsYUFBYSxTQUFTLFNBQVMsd0JBQXdC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QUUsaUJBQWlCLGtDQUFrQyx1REFBQyxFQUFFLHVGQUFDLHlDQUFtRSIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9jb3JlL2NvcmUvQnl0ZVNpemVVbml0LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9jb3JlL2NvcmUvTFJVQ2FjaGUuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2NvcmUvY29yZS9NZW1DYWNoZS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvY29yZS9nZW9tZXRyeS9zdXBwb3J0L1VpbnRBcnJheS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvY29yZS9sYXllcnMvbWl4aW5zL0FyY0dJU1NlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2NvcmUvbGF5ZXJzL3N1cHBvcnQvVGlsZW1hcC5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvY29yZS9sYXllcnMvc3VwcG9ydC9UaWxlbWFwQ2FjaGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjcvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbnZhciBFOyFmdW5jdGlvbihFKXtFW0UuS0lMT0JZVEVTPTEwMjRdPVwiS0lMT0JZVEVTXCIsRVtFLk1FR0FCWVRFUz0xMDQ4NTc2XT1cIk1FR0FCWVRFU1wiLEVbRS5HSUdBQllURVM9MTA3Mzc0MTgyNF09XCJHSUdBQllURVNcIn0oRXx8KEU9e30pKTtleHBvcnR7RSBhcyBCeXRlU2l6ZVVuaXR9O1xuIiwiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjcvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydHtNZW1DYWNoZVN0b3JhZ2UgYXMgdH1mcm9tXCIuL01lbUNhY2hlLmpzXCI7Y2xhc3MgZXtjb25zdHJ1Y3RvcihlLHMpe3RoaXMuX3N0b3JhZ2U9bmV3IHQsdGhpcy5pZD1cIlwiLHRoaXMubmFtZT1cIlwiLHRoaXMuc2l6ZT0wLHRoaXMuX3N0b3JhZ2UubWF4U2l6ZT1lLHRoaXMuX3N0b3JhZ2UucmVnaXN0ZXIodGhpcykscyYmdGhpcy5fc3RvcmFnZS5yZWdpc3RlclJlbW92ZUZ1bmMoXCJcIixzKX1kZXN0cm95KCl7dGhpcy5fc3RvcmFnZS5kZXJlZ2lzdGVyKHRoaXMpLHRoaXMuX3N0b3JhZ2UuZGVzdHJveSgpfXB1dCh0LGUscz0xKXt0aGlzLl9zdG9yYWdlLnB1dCh0aGlzLHQsZSxzLDEpfXBvcCh0KXtyZXR1cm4gdGhpcy5fc3RvcmFnZS5wb3AodGhpcyx0KX1nZXQodCl7cmV0dXJuIHRoaXMuX3N0b3JhZ2UuZ2V0KHRoaXMsdCl9Y2xlYXIoKXt0aGlzLl9zdG9yYWdlLmNsZWFyQWxsKCl9Z2V0IG1heFNpemUoKXtyZXR1cm4gdGhpcy5fc3RvcmFnZS5tYXhTaXplfXNldCBtYXhTaXplKHQpe3RoaXMuX3N0b3JhZ2UubWF4U2l6ZT10fXJlc2V0SGl0UmF0ZSgpe319ZXhwb3J0e2UgYXMgTFJVQ2FjaGV9O1xuIiwiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjcvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydCB0IGZyb21cIi4vUG9vbGVkQXJyYXkuanNcIjtjb25zdCBlPS0zO3ZhciBpOyFmdW5jdGlvbih0KXt0W3QuQUxMPTBdPVwiQUxMXCIsdFt0LlNPTUU9MV09XCJTT01FXCJ9KGl8fChpPXt9KSk7Y2xhc3Mgc3tjb25zdHJ1Y3Rvcih0LGUsaSl7dGhpcy5uYW1lPXQsdGhpcy5fc3RvcmFnZT1lLHRoaXMuaWQ9aCsrK1wiOlwiLHRoaXMuc2l6ZT0wLHRoaXMubWF4U2l6ZT0wLHRoaXMuX3JlbW92ZUZ1bmM9ITEsdGhpcy5faGl0PTAsdGhpcy5fbWlzcz0wLHRoaXMuX3N0b3JhZ2UucmVnaXN0ZXIodGhpcyksaSYmKHRoaXMuX3N0b3JhZ2UucmVnaXN0ZXJSZW1vdmVGdW5jKHRoaXMuaWQsaSksdGhpcy5fcmVtb3ZlRnVuYz0hMCl9ZGVzdHJveSgpe3RoaXMuX3N0b3JhZ2UuY2xlYXIodGhpcyksdGhpcy5fcmVtb3ZlRnVuYyYmdGhpcy5fc3RvcmFnZS5kZXJlZ2lzdGVyUmVtb3ZlRnVuYyh0aGlzLmlkKSx0aGlzLl9zdG9yYWdlLmRlcmVnaXN0ZXIodGhpcyksdGhpcy5fc3RvcmFnZT1udWxsfWdldCBoaXRSYXRlKCl7cmV0dXJuIHRoaXMuX2hpdC8odGhpcy5faGl0K3RoaXMuX21pc3MpfWdldCBzaXplQWxsKCl7cmV0dXJuIHRoaXMuX3N0b3JhZ2Uuc2l6ZX1yZXNldEhpdFJhdGUoKXt0aGlzLl9oaXQ9dGhpcy5fbWlzcz0wfXB1dCh0LGUsaSxzPTApe3RoaXMuX3N0b3JhZ2UucHV0KHRoaXMsdCxlLGkscyl9Z2V0KHQpe2NvbnN0IGU9dGhpcy5fc3RvcmFnZS5nZXQodGhpcyx0KTtyZXR1cm4gdm9pZCAwPT09ZT8rK3RoaXMuX21pc3M6Kyt0aGlzLl9oaXQsZX1wb3AodCl7Y29uc3QgZT10aGlzLl9zdG9yYWdlLnBvcCh0aGlzLHQpO3JldHVybiB2b2lkIDA9PT1lPysrdGhpcy5fbWlzczorK3RoaXMuX2hpdCxlfXVwZGF0ZVNpemUodCxlLGkpe3RoaXMuX3N0b3JhZ2UudXBkYXRlU2l6ZSh0aGlzLHQsZSxpKX1jbGVhcigpe3RoaXMuX3N0b3JhZ2UuY2xlYXIodGhpcyl9Y2xlYXJBbGwoKXt0aGlzLl9zdG9yYWdlLmNsZWFyQWxsKCl9Z2V0IHBlcmZvcm1hbmNlSW5mbygpe3JldHVybiB0aGlzLl9zdG9yYWdlLnBlcmZvcm1hbmNlSW5mb31yZXNldFN0YXRzKCl7dGhpcy5fc3RvcmFnZS5yZXNldFN0YXRzKCl9fWNsYXNzIHJ7Z2V0IHNpemUoKXtyZXR1cm4gdGhpcy5fc2l6ZX1jb25zdHJ1Y3RvcihlPTEwNDg1NzYwKXt0aGlzLl9tYXhTaXplPWUsdGhpcy5fZGI9bmV3IE1hcCx0aGlzLl9zaXplPTAsdGhpcy5faGl0PTAsdGhpcy5fbWlzcz0wLHRoaXMuX3JlbW92ZUZ1bmNzPW5ldyB0LHRoaXMuX3VzZXJzPW5ldyB0fWRlc3Ryb3koKXt0aGlzLmNsZWFyQWxsKCksdGhpcy5fcmVtb3ZlRnVuY3MuY2xlYXIoKSx0aGlzLl91c2Vycy5jbGVhcigpLHRoaXMuX2RiPW51bGx9cmVnaXN0ZXIodCl7dGhpcy5fdXNlcnMucHVzaCh0KX1kZXJlZ2lzdGVyKHQpe3RoaXMuX3VzZXJzLnJlbW92ZVVub3JkZXJlZCh0KX1yZWdpc3RlclJlbW92ZUZ1bmModCxlKXt0aGlzLl9yZW1vdmVGdW5jcy5wdXNoKFt0LGVdKX1kZXJlZ2lzdGVyUmVtb3ZlRnVuYyh0KXt0aGlzLl9yZW1vdmVGdW5jcy5maWx0ZXJJblBsYWNlKChlPT5lWzBdIT09dCkpfWdldCBtYXhTaXplKCl7cmV0dXJuIHRoaXMuX21heFNpemV9c2V0IG1heFNpemUodCl7dGhpcy5fbWF4U2l6ZT1NYXRoLm1heCh0LDApLHRoaXMuX2NoZWNrU2l6ZUxpbWl0cygpfXB1dCh0LHMscixoLG8pe3M9dC5pZCtzO2NvbnN0IG49dGhpcy5fZGIuZ2V0KHMpO2lmKG4mJih0aGlzLl9zaXplLT1uLnNpemUsdC5zaXplLT1uLnNpemUsdGhpcy5fZGIuZGVsZXRlKHMpLG4uZW50cnkhPT1yJiZ0aGlzLl9ub3RpZnlSZW1vdmUocyxuLmVudHJ5LGkuQUxMKSksaD50aGlzLl9tYXhTaXplKXJldHVybiB2b2lkIHRoaXMuX25vdGlmeVJlbW92ZShzLHIsaS5BTEwpO2lmKHZvaWQgMD09PXIpcmV0dXJuIHZvaWQgY29uc29sZS53YXJuKFwiUmVmdXNpbmcgdG8gY2FjaGUgdW5kZWZpbmVkIGVudHJ5IFwiKTtpZighaHx8aDwwKXJldHVybiB2b2lkIGNvbnNvbGUud2FybihcIlJlZnVzaW5nIHRvIGNhY2hlIGVudHJ5IHdpdGggaW52YWxpZCBzaXplIFwiK2gpO2NvbnN0IF89MStNYXRoLm1heChvLGUpLWU7dGhpcy5fZGIuc2V0KHMse2VudHJ5OnIsc2l6ZTpoLGxpZmV0aW1lOl8sbGl2ZXM6X30pLHRoaXMuX3NpemUrPWgsdC5zaXplKz1oLHRoaXMuX2NoZWNrU2l6ZUxpbWl0cygpfXVwZGF0ZVNpemUodCxlLHMscil7ZT10LmlkK2U7Y29uc3QgaD10aGlzLl9kYi5nZXQoZSk7aWYoaCYmaC5lbnRyeT09PXMpe2Zvcih0aGlzLl9zaXplLT1oLnNpemUsdC5zaXplLT1oLnNpemU7cj50aGlzLl9tYXhTaXplOyl7Y29uc3QgdD10aGlzLl9ub3RpZnlSZW1vdmUoZSxzLGkuU09NRSk7aWYoIShudWxsIT10JiZ0PjApKXJldHVybiB2b2lkIHRoaXMuX2RiLmRlbGV0ZShlKTtyPXR9aC5zaXplPXIsdGhpcy5fc2l6ZSs9cix0LnNpemUrPXIsdGhpcy5fY2hlY2tTaXplTGltaXRzKCl9fXBvcCh0LGUpe2U9dC5pZCtlO2NvbnN0IGk9dGhpcy5fZGIuZ2V0KGUpO2lmKGkpcmV0dXJuIHRoaXMuX3NpemUtPWkuc2l6ZSx0LnNpemUtPWkuc2l6ZSx0aGlzLl9kYi5kZWxldGUoZSksKyt0aGlzLl9oaXQsaS5lbnRyeTsrK3RoaXMuX21pc3N9Z2V0KHQsZSl7ZT10LmlkK2U7Y29uc3QgaT10aGlzLl9kYi5nZXQoZSk7aWYodm9pZCAwIT09aSlyZXR1cm4gdGhpcy5fZGIuZGVsZXRlKGUpLGkubGl2ZXM9aS5saWZldGltZSx0aGlzLl9kYi5zZXQoZSxpKSwrK3RoaXMuX2hpdCxpLmVudHJ5OysrdGhpcy5fbWlzc31nZXQgcGVyZm9ybWFuY2VJbmZvKCl7Y29uc3QgdD17U2l6ZTpNYXRoLnJvdW5kKHRoaXMuX3NpemUvMTA0ODU3NikrXCIvXCIrTWF0aC5yb3VuZCh0aGlzLl9tYXhTaXplLzEwNDg1NzYpK1wiTUJcIixcIkhpdCByYXRlXCI6TWF0aC5yb3VuZCgxMDAqdGhpcy5fZ2V0SGl0UmF0ZSgpKStcIiVcIixFbnRyaWVzOnRoaXMuX2RiLnNpemUudG9TdHJpbmcoKX0saT17fSxzPW5ldyBBcnJheTt0aGlzLl9kYi5mb3JFYWNoKCgodCxlKT0+e2NvbnN0IHI9dC5saWZldGltZTtzW3JdPShzW3JdfHwwKSt0LnNpemUsdGhpcy5fdXNlcnMuZm9yQWxsKChzPT57Y29uc3R7aWQ6cixuYW1lOmh9PXM7aWYoZS5zdGFydHNXaXRoKHIpKXtjb25zdCBlPWlbaF18fDA7aVtoXT1lK3Quc2l6ZX19KSl9KSk7Y29uc3Qgcj17fTt0aGlzLl91c2Vycy5mb3JBbGwoKHQ9Pntjb25zdCBlPXQubmFtZTtpZihcImhpdFJhdGVcImluIHQmJlwibnVtYmVyXCI9PXR5cGVvZiB0LmhpdFJhdGUmJiFpc05hTih0LmhpdFJhdGUpJiZ0LmhpdFJhdGU+MCl7Y29uc3Qgcz1pW2VdfHwwO2lbZV09cyxyW2VdPU1hdGgucm91bmQoMTAwKnQuaGl0UmF0ZSkrXCIlXCJ9ZWxzZSByW2VdPVwiMCVcIn0pKTtjb25zdCBoPU9iamVjdC5rZXlzKGkpO2guc29ydCgoKHQsZSk9PmlbZV0taVt0XSkpLGguZm9yRWFjaCgoZT0+dFtlXT1NYXRoLnJvdW5kKGlbZV0vMioqMjApK1wiTUIgLyBcIityW2VdKSk7Zm9yKGxldCBvPXMubGVuZ3RoLTE7bz49MDstLW8pe2NvbnN0IGk9c1tvXTtpJiYodFtcIlByaW9yaXR5IFwiKyhvK2UtMSldPU1hdGgucm91bmQoaS90aGlzLl9zaXplKjEwMCkrXCIlXCIpfXJldHVybiB0fXJlc2V0U3RhdHMoKXt0aGlzLl9oaXQ9dGhpcy5fbWlzcz0wLHRoaXMuX3VzZXJzLmZvckFsbCgodD0+dC5yZXNldEhpdFJhdGUoKSkpfWNsZWFyKHQpe2NvbnN0IGU9dC5pZDt0aGlzLl9kYi5mb3JFYWNoKCgodCxzKT0+e3Muc3RhcnRzV2l0aChlKSYmKHRoaXMuX3NpemUtPXQuc2l6ZSx0aGlzLl9kYi5kZWxldGUocyksdGhpcy5fbm90aWZ5UmVtb3ZlKHMsdC5lbnRyeSxpLkFMTCkpfSkpLHQuc2l6ZT0wfWNsZWFyQWxsKCl7dGhpcy5fZGIuZm9yRWFjaCgoKHQsZSk9PnRoaXMuX25vdGlmeVJlbW92ZShlLHQuZW50cnksaS5BTEwpKSksdGhpcy5fdXNlcnMuZm9yRWFjaCgodD0+dC5zaXplPTApKSx0aGlzLl9zaXplPTAsdGhpcy5fZGIuY2xlYXIoKX1fZ2V0SGl0UmF0ZSgpe3JldHVybiB0aGlzLl9oaXQvKHRoaXMuX2hpdCt0aGlzLl9taXNzKX1fbm90aWZ5UmVtb3ZlKHQsZSxpKXtsZXQgcztyZXR1cm4gdGhpcy5fcmVtb3ZlRnVuY3Muc29tZSgocj0+e2lmKHQuc3RhcnRzV2l0aChyWzBdKSl7Y29uc3QgdD1yWzFdKGUsaSk7cmV0dXJuXCJudW1iZXJcIj09dHlwZW9mIHQmJihzPXQpLCEwfXJldHVybiExfSkpLHN9X2NoZWNrU2l6ZUxpbWl0cygpe2lmKHRoaXMuX3NpemU+dGhpcy5fbWF4U2l6ZSlmb3IoY29uc3RbdCxlXW9mIHRoaXMuX2RiKWlmKHRoaXMuX3B1cmdlSXRlbSh0LGUpLHRoaXMuX3NpemU8PS45KnRoaXMubWF4U2l6ZSlyZXR1cm47dGhpcy5fdXNlcnMuZm9yRWFjaCgodD0+e2lmKHQubWF4U2l6ZT4wJiZ0LnNpemU+dC5tYXhTaXplKWZvcihjb25zdFtlLGldb2YgdGhpcy5fZGIpaWYoZS5zdGFydHNXaXRoKHQuaWQpJiYodGhpcy5fcHVyZ2VJdGVtKGUsaSx0KSx0LnNpemU8PS45KnQubWF4U2l6ZSkpcmV0dXJufSkpfV9wdXJnZUl0ZW0odCxlLHM9dGhpcy5fdXNlcnMuZmluZCgoZT0+dC5zdGFydHNXaXRoKGUuaWQpKSkpe2lmKHRoaXMuX2RiLmRlbGV0ZSh0KSxlLmxpdmVzPD0xKXt0aGlzLl9zaXplLT1lLnNpemUscyYmKHMuc2l6ZS09ZS5zaXplKTtjb25zdCByPXRoaXMuX25vdGlmeVJlbW92ZSh0LGUuZW50cnksaS5TT01FKTtudWxsIT1yJiZyPjAmJih0aGlzLl9zaXplKz1yLHMmJihzLnNpemUrPXIpLGUubGl2ZXM9ZS5saWZldGltZSxlLnNpemU9cix0aGlzLl9kYi5zZXQodCxlKSl9ZWxzZS0tZS5saXZlcyx0aGlzLl9kYi5zZXQodCxlKX19bGV0IGg9MDtleHBvcnR7ZSBhcyBNSU5fUFJJT1JJVFkscyBhcyBNZW1DYWNoZSxyIGFzIE1lbUNhY2hlU3RvcmFnZSxpIGFzIFJlbW92ZU1vZGV9O1xuIiwiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjcvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydHtOQVRJVkVfQVJSQVlfTUFYX1NJWkUgYXMgcixpc0FycmF5IGFzIG59ZnJvbVwiLi4vLi4vY29yZS90eXBlZEFycmF5VXRpbC5qc1wiO2Z1bmN0aW9uIHQobix0PSExKXtyZXR1cm4gbjw9cj90P25ldyBBcnJheShuKS5maWxsKDApOm5ldyBBcnJheShuKTpuZXcgVWludDMyQXJyYXkobil9ZnVuY3Rpb24gZSh0KXtyZXR1cm4obih0KT90Lmxlbmd0aDp0LmJ5dGVMZW5ndGgvOCk8PXI/QXJyYXkuZnJvbSh0KTpuZXcgVWludDMyQXJyYXkodCl9ZnVuY3Rpb24geShyLG4sdCl7cmV0dXJuIEFycmF5LmlzQXJyYXkocik/ci5zbGljZShuLG4rdCk6ci5zdWJhcnJheShuLG4rdCl9ZXhwb3J0e3QgYXMgbmV3VWludEFycmF5LGUgYXMgdWludEFycmF5RnJvbSx5IGFzIHVpbnRTdWJBcnJheX07XG4iLCIvKlxuQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cblNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4yNy9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4qL1xuaW1wb3J0e18gYXMgdH1mcm9tXCIuLi8uLi9jaHVua3MvdHNsaWIuZXM2LmpzXCI7aW1wb3J0IHIgZnJvbVwiLi4vLi4vY29yZS9Mb2dnZXIuanNcIjtpbXBvcnR7cHJvcGVydHkgYXMgZX1mcm9tXCIuLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9kZWNvcmF0b3JzL3Byb3BlcnR5LmpzXCI7aW1wb3J0XCIuLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9lbnN1cmVUeXBlLmpzXCI7aW1wb3J0XCIuLi8uLi9jb3JlL2FycmF5VXRpbHMuanNcIjtpbXBvcnRcIi4uLy4uL2NvcmUvaGFzLmpzXCI7aW1wb3J0e3N1YmNsYXNzIGFzIHN9ZnJvbVwiLi4vLi4vY29yZS9hY2Nlc3NvclN1cHBvcnQvZGVjb3JhdG9ycy9zdWJjbGFzcy5qc1wiO2ltcG9ydHtwYXJzZSBhcyBvLHNhbml0aXplVXJsIGFzIGl9ZnJvbVwiLi4vc3VwcG9ydC9hcmNnaXNMYXllclVybC5qc1wiO2NvbnN0IGw9bD0+e2xldCBwPWNsYXNzIGV4dGVuZHMgbHtnZXQgdGl0bGUoKXtpZih0aGlzLl9nZXQoXCJ0aXRsZVwiKSYmXCJkZWZhdWx0c1wiIT09dGhpcy5vcmlnaW5PZihcInRpdGxlXCIpKXJldHVybiB0aGlzLl9nZXQoXCJ0aXRsZVwiKTtpZih0aGlzLnVybCl7Y29uc3QgdD1vKHRoaXMudXJsKTtpZihudWxsIT10JiZ0LnRpdGxlKXJldHVybiB0LnRpdGxlfXJldHVybiB0aGlzLl9nZXQoXCJ0aXRsZVwiKXx8XCJcIn1zZXQgdGl0bGUodCl7dGhpcy5fc2V0KFwidGl0bGVcIix0KX1zZXQgdXJsKHQpe3RoaXMuX3NldChcInVybFwiLGkodCxyLmdldExvZ2dlcih0aGlzKSkpfX07cmV0dXJuIHQoW2UoKV0scC5wcm90b3R5cGUsXCJ0aXRsZVwiLG51bGwpLHQoW2Uoe3R5cGU6U3RyaW5nfSldLHAucHJvdG90eXBlLFwidXJsXCIsbnVsbCkscD10KFtzKFwiZXNyaS5sYXllcnMubWl4aW5zLkFyY0dJU1NlcnZpY2VcIildLHApLHB9O2V4cG9ydHtsIGFzIEFyY0dJU1NlcnZpY2V9O1xuIiwiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjcvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydCB0IGZyb21cIi4uLy4uL3JlcXVlc3QuanNcIjtpbXBvcnR7Y29uc3RhbnQgYXMgaX1mcm9tXCIuLi8uLi9jb3JlL2FycmF5VXRpbHMuanNcIjtpbXBvcnQgZSBmcm9tXCIuLi8uLi9jb3JlL0Vycm9yLmpzXCI7aW1wb3J0e2Nsb25lIGFzIGF9ZnJvbVwiLi4vLi4vY29yZS9sYW5nLmpzXCI7aW1wb3J0e2VzdGltYXRlU2l6ZSBhcyBvfWZyb21cIi4uLy4uL2NvcmUvdHlwZWRBcnJheVV0aWwuanNcIjtpbXBvcnR7bmV3VWludEFycmF5IGFzIGx9ZnJvbVwiLi4vLi4vZ2VvbWV0cnkvc3VwcG9ydC9VaW50QXJyYXkuanNcIjtjbGFzcyBye2NvbnN0cnVjdG9yKHQpe3RoaXMuX3ZhbGlkYXRlSlNPTih0KTtjb25zdHtsb2NhdGlvbjppLGRhdGE6ZX09dDt0aGlzLmxvY2F0aW9uPU9iamVjdC5mcmVlemUoYShpKSk7Y29uc3Qgcj10aGlzLmxvY2F0aW9uLndpZHRoLG49dGhpcy5sb2NhdGlvbi5oZWlnaHQ7bGV0IHM9ITAsaD0hMDtjb25zdCBjPU1hdGguY2VpbChyKm4vMzIpLG09bChjKTtsZXQgZj0wO2ZvcihsZXQgYT0wO2E8ZS5sZW5ndGg7YSsrKXtjb25zdCB0PWElMzI7ZVthXT8oaD0hMSxtW2ZdfD0xPDx0KTpzPSExLDMxPT09dCYmKytmfWg/KHRoaXMuX2F2YWlsYWJpbGl0eT1cInVuYXZhaWxhYmxlXCIsdGhpcy5ieXRlU2l6ZT00MCk6cz8odGhpcy5fYXZhaWxhYmlsaXR5PVwiYXZhaWxhYmxlXCIsdGhpcy5ieXRlU2l6ZT00MCk6KHRoaXMuX2F2YWlsYWJpbGl0eT1tLHRoaXMuYnl0ZVNpemU9NDArbyhtKSl9Z2V0QXZhaWxhYmlsaXR5KHQsaSl7aWYoXCJ1bmF2YWlsYWJsZVwiPT09dGhpcy5fYXZhaWxhYmlsaXR5fHxcImF2YWlsYWJsZVwiPT09dGhpcy5fYXZhaWxhYmlsaXR5KXJldHVybiB0aGlzLl9hdmFpbGFiaWxpdHk7Y29uc3QgZT0odC10aGlzLmxvY2F0aW9uLnRvcCkqdGhpcy5sb2NhdGlvbi53aWR0aCsoaS10aGlzLmxvY2F0aW9uLmxlZnQpLGE9ZSUzMixvPWU+PjUsbD10aGlzLl9hdmFpbGFiaWxpdHk7cmV0dXJuIG88MHx8bz5sLmxlbmd0aD9cInVua25vd25cIjpsW29dJjE8PGE/XCJhdmFpbGFibGVcIjpcInVuYXZhaWxhYmxlXCJ9c3RhdGljIGZyb21EZWZpbml0aW9uKGEsbyl7Y29uc3QgbD1hLnNlcnZpY2UucmVxdWVzdHx8dCx7cm93Om4sY29sOmgsd2lkdGg6YyxoZWlnaHQ6bX09YSxmPXtxdWVyeTp7ZjpcImpzb25cIn19O3JldHVybiBvPW8/ey4uLmYsLi4ub306ZixsKHMoYSksbykudGhlbigodD0+dC5kYXRhKSkuY2F0Y2goKHQ9PntpZih0JiZ0LmRldGFpbHMmJjQyMj09PXQuZGV0YWlscy5odHRwU3RhdHVzKXJldHVybntsb2NhdGlvbjp7dG9wOm4sbGVmdDpoLHdpZHRoOmMsaGVpZ2h0Om19LHZhbGlkOiEwLGRhdGE6aShjKm0sMCl9O3Rocm93IHR9KSkudGhlbigodD0+e2lmKHQubG9jYXRpb24mJih0LmxvY2F0aW9uLnRvcCE9PW58fHQubG9jYXRpb24ubGVmdCE9PWh8fHQubG9jYXRpb24ud2lkdGghPT1jfHx0LmxvY2F0aW9uLmhlaWdodCE9PW0pKXRocm93IG5ldyBlKFwidGlsZW1hcDpsb2NhdGlvbi1taXNtYXRjaFwiLFwiVGlsZW1hcCByZXNwb25zZSBmb3IgZGlmZmVyZW50IGxvY2F0aW9uIHRoYW4gcmVxdWVzdGVkXCIse3Jlc3BvbnNlOnQsZGVmaW5pdGlvbjp7dG9wOm4sbGVmdDpoLHdpZHRoOmMsaGVpZ2h0Om19fSk7cmV0dXJuIHIuZnJvbUpTT04odCl9KSl9c3RhdGljIGZyb21KU09OKHQpe3JldHVybiBPYmplY3QuZnJlZXplKG5ldyByKHQpKX1fdmFsaWRhdGVKU09OKHQpe2lmKCF0fHwhdC5sb2NhdGlvbil0aHJvdyBuZXcgZShcInRpbGVtYXA6bWlzc2luZy1sb2NhdGlvblwiLFwiTG9jYXRpb24gbWlzc2luZyBmcm9tIHRpbGVtYXAgcmVzcG9uc2VcIik7aWYoITE9PT10LnZhbGlkKXRocm93IG5ldyBlKFwidGlsZW1hcDppbnZhbGlkXCIsXCJUaWxlbWFwIHJlc3BvbnNlIHdhcyBtYXJrZWQgYXMgaW52YWxpZFwiKTtpZighdC5kYXRhKXRocm93IG5ldyBlKFwidGlsZW1hcDptaXNzaW5nLWRhdGFcIixcIkRhdGEgbWlzc2luZyBmcm9tIHRpbGVtYXAgcmVzcG9uc2VcIik7aWYoIUFycmF5LmlzQXJyYXkodC5kYXRhKSl0aHJvdyBuZXcgZShcInRpbGVtYXA6ZGF0YS1taXNtYXRjaFwiLFwiRGF0YSBtdXN0IGJlIGFuIGFycmF5IG9mIG51bWJlcnNcIik7aWYodC5kYXRhLmxlbmd0aCE9PXQubG9jYXRpb24ud2lkdGgqdC5sb2NhdGlvbi5oZWlnaHQpdGhyb3cgbmV3IGUoXCJ0aWxlbWFwOmRhdGEtbWlzbWF0Y2hcIixcIk51bWJlciBvZiBkYXRhIGl0ZW1zIGRvZXMgbm90IG1hdGNoIHdpZHRoL2hlaWdodCBvZiB0aWxlbWFwXCIpfX1mdW5jdGlvbiBuKHQpe3JldHVybmAke3QubGV2ZWx9LyR7dC5yb3d9LyR7dC5jb2x9LyR7dC53aWR0aH0vJHt0LmhlaWdodH1gfWZ1bmN0aW9uIHModCl7bGV0IGk7aWYodC5zZXJ2aWNlLnRpbGVTZXJ2ZXJzPy5sZW5ndGgpe2NvbnN0IGU9dC5zZXJ2aWNlLnRpbGVTZXJ2ZXJzO2k9YCR7ZSYmZS5sZW5ndGg/ZVt0LnJvdyVlLmxlbmd0aF06dC5zZXJ2aWNlLnVybH0vdGlsZW1hcC8ke3QubGV2ZWx9LyR7dC5yb3d9LyR7dC5jb2x9LyR7dC53aWR0aH0vJHt0LmhlaWdodH1gfWVsc2UgaT1gJHt0LnNlcnZpY2UudXJsfS90aWxlbWFwLyR7dC5sZXZlbH0vJHt0LnJvd30vJHt0LmNvbH0vJHt0LndpZHRofS8ke3QuaGVpZ2h0fWA7Y29uc3QgZT10LnNlcnZpY2UucXVlcnk7cmV0dXJuIGUmJihpPWAke2l9PyR7ZX1gKSxpfWV4cG9ydHtyIGFzIFRpbGVtYXAsbiBhcyB0aWxlbWFwRGVmaW5pdGlvbklkfTtcbiIsIi8qXG5BbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjI3L2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiovXG5pbXBvcnR7XyBhcyBlfWZyb21cIi4uLy4uL2NodW5rcy90c2xpYi5lczYuanNcIjtpbXBvcnQgdCBmcm9tXCIuLi8uLi9yZXF1ZXN0LmpzXCI7aW1wb3J0IGkgZnJvbVwiLi4vLi4vY29yZS9BY2Nlc3Nvci5qc1wiO2ltcG9ydHtCeXRlU2l6ZVVuaXQgYXMgcn1mcm9tXCIuLi8uLi9jb3JlL0J5dGVTaXplVW5pdC5qc1wiO2ltcG9ydCBzIGZyb21cIi4uLy4uL2NvcmUvRXJyb3IuanNcIjtpbXBvcnR7bWFrZUhhbmRsZSBhcyBsfWZyb21cIi4uLy4uL2NvcmUvaGFuZGxlVXRpbHMuanNcIjtpbXBvcnR7TFJVQ2FjaGUgYXMgb31mcm9tXCIuLi8uLi9jb3JlL0xSVUNhY2hlLmpzXCI7aW1wb3J0IGEgZnJvbVwiLi4vLi4vY29yZS9Qb29sZWRBcnJheS5qc1wiO2ltcG9ydHtvbkFib3J0IGFzIG4sY3JlYXRlQWJvcnRFcnJvciBhcyBjLGlzQWJvcnRFcnJvciBhcyBoLGlzQWJvcnRlZCBhcyBwfWZyb21cIi4uLy4uL2NvcmUvcHJvbWlzZVV0aWxzLmpzXCI7aW1wb3J0e3dhdGNoIGFzIG0saW5pdGlhbCBhcyBmfWZyb21cIi4uLy4uL2NvcmUvcmVhY3RpdmVVdGlscy5qc1wiO2ltcG9ydHt3YWl0VGlja3MgYXMgdX1mcm9tXCIuLi8uLi9jb3JlL3NjaGVkdWxpbmcuanNcIjtpbXBvcnR7b2JqZWN0VG9RdWVyeSBhcyB2fWZyb21cIi4uLy4uL2NvcmUvdXJsVXRpbHMuanNcIjtpbXBvcnR7cHJvcGVydHkgYXMgeX1mcm9tXCIuLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9kZWNvcmF0b3JzL3Byb3BlcnR5LmpzXCI7aW1wb3J0XCIuLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9lbnN1cmVUeXBlLmpzXCI7aW1wb3J0XCIuLi8uLi9jb3JlL2FycmF5VXRpbHMuanNcIjtpbXBvcnRcIi4uLy4uL2NvcmUvaGFzLmpzXCI7aW1wb3J0e3N1YmNsYXNzIGFzIGR9ZnJvbVwiLi4vLi4vY29yZS9hY2Nlc3NvclN1cHBvcnQvZGVjb3JhdG9ycy9zdWJjbGFzcy5qc1wiO2ltcG9ydHtUaWxlS2V5IGFzIF99ZnJvbVwiLi9UaWxlS2V5LmpzXCI7aW1wb3J0e3RpbGVtYXBEZWZpbml0aW9uSWQgYXMgYixUaWxlbWFwIGFzIGd9ZnJvbVwiLi9UaWxlbWFwLmpzXCI7dmFyIHc7bGV0IFQ9dz1jbGFzcyBleHRlbmRzIGl7Y29uc3RydWN0b3IoZSl7c3VwZXIoZSksdGhpcy5fcGVuZGluZ1RpbGVtYXBSZXF1ZXN0cz17fSx0aGlzLnJlcXVlc3Q9dCx0aGlzLnNpemU9MzIsdGhpcy5fcHJlZmV0Y2hpbmdFbmFibGVkPSEwfWluaXRpYWxpemUoKXt0aGlzLl90aWxlbWFwQ2FjaGU9bmV3IG8oMipyLk1FR0FCWVRFUyksdGhpcy5hZGRIYW5kbGVzKFttKCgoKT0+e2NvbnN0e2xheWVyOmV9PXRoaXM7cmV0dXJuW2U/LnBhcnNlZFVybCxlPy50aWxlU2VydmVycyxlPy5hcGlLZXksZT8uY3VzdG9tUGFyYW1ldGVyc119KSwoKCk9PnRoaXMuX2luaXRpYWxpemVUaWxlbWFwRGVmaW5pdGlvbigpKSxmKV0pfWdldCBlZmZlY3RpdmVNaW5MT0QoKXtyZXR1cm4gdGhpcy5taW5MT0Q/P3RoaXMubGF5ZXIudGlsZUluZm8ubG9kc1swXS5sZXZlbH1nZXQgZWZmZWN0aXZlTWF4TE9EKCl7cmV0dXJuIHRoaXMubWF4TE9EPz90aGlzLmxheWVyLnRpbGVJbmZvLmxvZHNbdGhpcy5sYXllci50aWxlSW5mby5sb2RzLmxlbmd0aC0xXS5sZXZlbH1mZXRjaFRpbGVtYXAoZSx0LGkscil7aWYoIXRoaXMubGF5ZXIudGlsZUluZm8ubG9kQXQoZSl8fGU8dGhpcy5lZmZlY3RpdmVNaW5MT0R8fGU+dGhpcy5lZmZlY3RpdmVNYXhMT0QpcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBzKFwidGlsZW1hcC1jYWNoZTpsZXZlbC11bmF2YWlsYWJsZVwiLGBMZXZlbCAke2V9IGlzIHVuYXZhaWxhYmxlIGluIHRoZSBzZXJ2aWNlYCkpO2NvbnN0IGw9dGhpcy5fdG1wVGlsZW1hcERlZmluaXRpb24sbz10aGlzLl90aWxlbWFwRnJvbUNhY2hlKGUsdCxpLGwpO2lmKG8pcmV0dXJuIFByb21pc2UucmVzb2x2ZShvKTtjb25zdCBhPXImJnIuc2lnbmFsO3JldHVybiByPXsuLi5yLHNpZ25hbDpudWxsfSxuZXcgUHJvbWlzZSgoKGUsdCk9PntuKGEsKCgpPT50KGMoKSkpKTtjb25zdCBpPWIobCk7bGV0IHM9dGhpcy5fcGVuZGluZ1RpbGVtYXBSZXF1ZXN0c1tpXTtpZighcyl7cz1nLmZyb21EZWZpbml0aW9uKGwscikudGhlbigoZT0+KHRoaXMuX3RpbGVtYXBDYWNoZS5wdXQoaSxlLGUuYnl0ZVNpemUpLGUpKSk7Y29uc3QgZT0oKT0+ZGVsZXRlIHRoaXMuX3BlbmRpbmdUaWxlbWFwUmVxdWVzdHNbaV07dGhpcy5fcGVuZGluZ1RpbGVtYXBSZXF1ZXN0c1tpXT1zLHMudGhlbihlLGUpfXMudGhlbihlLHQpfSkpfWdldEF2YWlsYWJpbGl0eShlLHQsaSl7aWYoIXRoaXMubGF5ZXIudGlsZUluZm8ubG9kQXQoZSl8fGU8dGhpcy5lZmZlY3RpdmVNaW5MT0R8fGU+dGhpcy5lZmZlY3RpdmVNYXhMT0QpcmV0dXJuXCJ1bmF2YWlsYWJsZVwiO2NvbnN0IHI9dGhpcy5fdGlsZW1hcEZyb21DYWNoZShlLHQsaSx0aGlzLl90bXBUaWxlbWFwRGVmaW5pdGlvbik7cmV0dXJuIHI/ci5nZXRBdmFpbGFiaWxpdHkodCxpKTpcInVua25vd25cIn1mZXRjaEF2YWlsYWJpbGl0eShlLHQsaSxyKXtyZXR1cm4hdGhpcy5sYXllci50aWxlSW5mby5sb2RBdChlKXx8ZTx0aGlzLmVmZmVjdGl2ZU1pbkxPRHx8ZT50aGlzLmVmZmVjdGl2ZU1heExPRD9Qcm9taXNlLnJlamVjdChuZXcgcyhcInRpbGUtbWFwOnRpbGUtdW5hdmFpbGFibGVcIixcIlRpbGUgaXMgbm90IGF2YWlsYWJsZVwiLHtsZXZlbDplLHJvdzp0LGNvbDppfSkpOnRoaXMuZmV0Y2hUaWxlbWFwKGUsdCxpLHIpLmNhdGNoKChlPT5lKSkudGhlbigocj0+e2lmKHIgaW5zdGFuY2VvZiBnKXtjb25zdCBsPXIuZ2V0QXZhaWxhYmlsaXR5KHQsaSk7aWYoXCJ1bmF2YWlsYWJsZVwiPT09bCl0aHJvdyBuZXcgcyhcInRpbGUtbWFwOnRpbGUtdW5hdmFpbGFibGVcIixcIlRpbGUgaXMgbm90IGF2YWlsYWJsZVwiLHtsZXZlbDplLHJvdzp0LGNvbDppfSk7cmV0dXJuIGx9aWYoaChyKSl0aHJvdyByO3JldHVyblwidW5rbm93blwifSkpfWZldGNoQXZhaWxhYmlsaXR5VXBzYW1wbGUoZSx0LGkscixzKXtyLmxldmVsPWUsci5yb3c9dCxyLmNvbD1pO2NvbnN0IGw9dGhpcy5sYXllci50aWxlSW5mbztsLnVwZGF0ZVRpbGVJbmZvKHIpO2NvbnN0IG89dGhpcy5mZXRjaEF2YWlsYWJpbGl0eShlLHQsaSxzKS5jYXRjaCgoZT0+e2lmKGgoZSkpdGhyb3cgZTtpZihsLnVwc2FtcGxlVGlsZShyKSlyZXR1cm4gdGhpcy5mZXRjaEF2YWlsYWJpbGl0eVVwc2FtcGxlKHIubGV2ZWwsci5yb3csci5jb2wscixzKTt0aHJvdyBlfSkpO3JldHVybiB0aGlzLl9mZXRjaEF2YWlsYWJpbGl0eVVwc2FtcGxlUHJlZmV0Y2goci5pZCxlLHQsaSxzLG8pLG99YXN5bmMgX2ZldGNoQXZhaWxhYmlsaXR5VXBzYW1wbGVQcmVmZXRjaChlLHQsaSxyLHMsbyl7aWYoIXRoaXMuX3ByZWZldGNoaW5nRW5hYmxlZHx8bnVsbD09ZSlyZXR1cm47Y29uc3QgYT1gcHJlZmV0Y2gtJHtlfWA7aWYodGhpcy5oYXNIYW5kbGVzKGEpKXJldHVybjtjb25zdCBuPW5ldyBBYm9ydENvbnRyb2xsZXI7by50aGVuKCgoKT0+bi5hYm9ydCgpKSwoKCk9Pm4uYWJvcnQoKSkpO2xldCBjPSExO2NvbnN0IGg9bCgoKCk9PntjfHwoYz0hMCxuLmFib3J0KCkpfSkpO2lmKHRoaXMuYWRkSGFuZGxlcyhoLGEpLGF3YWl0IHUoMTAsbi5zaWduYWwpLmNhdGNoKCgoKT0+e30pKSxjfHwoYz0hMCx0aGlzLnJlbW92ZUhhbmRsZXMoYSkpLHAobikpcmV0dXJuO2NvbnN0IG09bmV3IF8oZSx0LGksciksZj17Li4ucyxzaWduYWw6bi5zaWduYWx9LHY9dGhpcy5sYXllci50aWxlSW5mbztmb3IobGV0IGw9MDt3Ll9wcmVmZXRjaGVzLmxlbmd0aDx3Ll9tYXhQcmVmZXRjaCYmdi51cHNhbXBsZVRpbGUobSk7KytsKXtjb25zdCBlPXRoaXMuZmV0Y2hBdmFpbGFiaWxpdHkobS5sZXZlbCxtLnJvdyxtLmNvbCxmKTt3Ll9wcmVmZXRjaGVzLnB1c2goZSk7Y29uc3QgdD0oKT0+e3cuX3ByZWZldGNoZXMucmVtb3ZlVW5vcmRlcmVkKGUpfTtlLnRoZW4odCx0KX19X2luaXRpYWxpemVUaWxlbWFwRGVmaW5pdGlvbigpe2lmKCF0aGlzLmxheWVyLnBhcnNlZFVybClyZXR1cm47Y29uc3R7cGFyc2VkVXJsOmUsYXBpS2V5OnQsY3VzdG9tUGFyYW1ldGVyczppfT10aGlzLmxheWVyO3RoaXMuX3RpbGVtYXBDYWNoZS5jbGVhcigpLHRoaXMuX3RtcFRpbGVtYXBEZWZpbml0aW9uPXtzZXJ2aWNlOnt1cmw6ZS5wYXRoLHF1ZXJ5OnYoey4uLmUucXVlcnksLi4uaSx0b2tlbjp0Pz9lLnF1ZXJ5Py50b2tlbn0pLHRpbGVTZXJ2ZXJzOnRoaXMubGF5ZXIudGlsZVNlcnZlcnMscmVxdWVzdDp0aGlzLnJlcXVlc3R9LHdpZHRoOnRoaXMuc2l6ZSxoZWlnaHQ6dGhpcy5zaXplLGxldmVsOjAscm93OjAsY29sOjB9fV90aWxlbWFwRnJvbUNhY2hlKGUsdCxpLHIpe3IubGV2ZWw9ZSxyLnJvdz10LXQldGhpcy5zaXplLHIuY29sPWktaSV0aGlzLnNpemU7Y29uc3Qgcz1iKHIpO3JldHVybiB0aGlzLl90aWxlbWFwQ2FjaGUuZ2V0KHMpfWdldCB0ZXN0KCl7Y29uc3QgZT10aGlzO3JldHVybntnZXQgcHJlZmV0Y2hpbmdFbmFibGVkKCl7cmV0dXJuIGUuX3ByZWZldGNoaW5nRW5hYmxlZH0sc2V0IHByZWZldGNoaW5nRW5hYmxlZCh0KXtlLl9wcmVmZXRjaGluZ0VuYWJsZWQ9dH0saGFzVGlsZW1hcDoodCxpLHIpPT4hIWUuX3RpbGVtYXBGcm9tQ2FjaGUodCxpLHIsZS5fdG1wVGlsZW1hcERlZmluaXRpb24pfX19O1QuX21heFByZWZldGNoPTQsVC5fcHJlZmV0Y2hlcz1uZXcgYSh7aW5pdGlhbFNpemU6dy5fbWF4UHJlZmV0Y2h9KSxlKFt5KHtjb25zdHJ1Y3RPbmx5OiEwfSldLFQucHJvdG90eXBlLFwibGF5ZXJcIix2b2lkIDApLGUoW3koe2NvbnN0cnVjdE9ubHk6ITB9KV0sVC5wcm90b3R5cGUsXCJtaW5MT0RcIix2b2lkIDApLGUoW3koe2NvbnN0cnVjdE9ubHk6ITB9KV0sVC5wcm90b3R5cGUsXCJtYXhMT0RcIix2b2lkIDApLGUoW3koe2NvbnN0cnVjdE9ubHk6ITB9KV0sVC5wcm90b3R5cGUsXCJyZXF1ZXN0XCIsdm9pZCAwKSxlKFt5KHtjb25zdHJ1Y3RPbmx5OiEwfSldLFQucHJvdG90eXBlLFwic2l6ZVwiLHZvaWQgMCksVD13PWUoW2QoXCJlc3JpLmxheWVycy5zdXBwb3J0LlRpbGVtYXBDYWNoZVwiKV0sVCk7ZXhwb3J0e1QgYXMgVGlsZW1hcENhY2hlfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==