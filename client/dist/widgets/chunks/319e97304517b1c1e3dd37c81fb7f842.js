"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["node_modules_arcgis_core_views_2d_layers_RouteLayerView2D_js"],{

/***/ "./node_modules/@arcgis/core/views/2d/layers/RouteLayerView2D.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/RouteLayerView2D.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ I)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/arrayUtils.js */ "./node_modules/@arcgis/core/core/arrayUtils.js");
/* harmony import */ var _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/Collection.js */ "./node_modules/@arcgis/core/core/Collection.js");
/* harmony import */ var _core_CollectionFlattener_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/CollectionFlattener.js */ "./node_modules/@arcgis/core/core/CollectionFlattener.js");
/* harmony import */ var _core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/reactiveUtils.js */ "./node_modules/@arcgis/core/core/reactiveUtils.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/accessorSupport/ensureType.js */ "./node_modules/@arcgis/core/core/accessorSupport/ensureType.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _rest_support_DirectionLine_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../rest/support/DirectionLine.js */ "./node_modules/@arcgis/core/rest/support/DirectionLine.js");
/* harmony import */ var _rest_support_DirectionPoint_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../rest/support/DirectionPoint.js */ "./node_modules/@arcgis/core/rest/support/DirectionPoint.js");
/* harmony import */ var _rest_support_PointBarrier_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../rest/support/PointBarrier.js */ "./node_modules/@arcgis/core/rest/support/PointBarrier.js");
/* harmony import */ var _rest_support_PolygonBarrier_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../rest/support/PolygonBarrier.js */ "./node_modules/@arcgis/core/rest/support/PolygonBarrier.js");
/* harmony import */ var _rest_support_PolylineBarrier_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../rest/support/PolylineBarrier.js */ "./node_modules/@arcgis/core/rest/support/PolylineBarrier.js");
/* harmony import */ var _rest_support_RouteInfo_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../rest/support/RouteInfo.js */ "./node_modules/@arcgis/core/rest/support/RouteInfo.js");
/* harmony import */ var _rest_support_Stop_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../rest/support/Stop.js */ "./node_modules/@arcgis/core/rest/support/Stop.js");
/* harmony import */ var _LayerView2D_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./LayerView2D.js */ "./node_modules/@arcgis/core/views/2d/layers/LayerView2D.js");
/* harmony import */ var _graphics_GraphicContainer_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./graphics/GraphicContainer.js */ "./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicContainer.js");
/* harmony import */ var _graphics_GraphicsView2D_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./graphics/GraphicsView2D.js */ "./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicsView2D.js");
/* harmony import */ var _layers_LayerView_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../layers/LayerView.js */ "./node_modules/@arcgis/core/views/layers/LayerView.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
const y=Object.freeze({remove(){},pause(){},resume(){}}),k=["route-info","direction-line","direction-point","polygon-barrier","polyline-barrier","point-barrier","stop"],v={graphic:null,property:null,oldValue:null,newValue:null};function M(t){return t instanceof _rest_support_DirectionLine_js__WEBPACK_IMPORTED_MODULE_9__["default"]||t instanceof _rest_support_DirectionPoint_js__WEBPACK_IMPORTED_MODULE_10__["default"]||t instanceof _rest_support_PointBarrier_js__WEBPACK_IMPORTED_MODULE_11__["default"]||t instanceof _rest_support_PolygonBarrier_js__WEBPACK_IMPORTED_MODULE_12__["default"]||t instanceof _rest_support_PolylineBarrier_js__WEBPACK_IMPORTED_MODULE_13__["default"]||t instanceof _rest_support_RouteInfo_js__WEBPACK_IMPORTED_MODULE_14__["default"]||t instanceof _rest_support_Stop_js__WEBPACK_IMPORTED_MODULE_15__["default"]}function V(t){return _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__["default"].isCollection(t)&&t.length&&M(t.at(0))}function j(t){return Array.isArray(t)&&t.length>0&&M(t[0])}let G=class extends((0,_LayerView2D_js__WEBPACK_IMPORTED_MODULE_16__.LayerView2DMixin)(_layers_LayerView_js__WEBPACK_IMPORTED_MODULE_19__["default"])){constructor(){super(...arguments),this._graphics=new _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__["default"],this._highlightIds=new Map,this._networkFeatureMap=new Map,this._networkGraphicMap=new Map}get _routeItems(){return new _core_CollectionFlattener_js__WEBPACK_IMPORTED_MODULE_3__["default"]({getCollections:()=>null==this.layer||this.destroyed?[]:[null!=this.layer.routeInfo?new _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__["default"]([this.layer.routeInfo]):null,this.layer.directionLines,this.layer.directionPoints,this.layer.polygonBarriers,this.layer.polylineBarriers,this.layer.pointBarriers,this.layer.stops]})}initialize(){this.updatingHandles.addOnCollectionChange((()=>this._routeItems),(t=>this._routeItemsChanged(t)),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__.initial)}destroy(){this._networkFeatureMap.clear(),this._networkGraphicMap.clear(),this._graphics.removeAll(),this._get("_routeItems")?.destroy()}attach(){this._createGraphicsView()}detach(){this._destroyGraphicsView()}async fetchPopupFeatures(t){return this._graphicsView.hitTest(t).filter((t=>!!t.popupTemplate))}highlight(t){let r;r=M(t)?[this._getNetworkFeatureUid(t)]:j(t)?t.map((t=>this._getNetworkFeatureUid(t))):V(t)?t.map((t=>this._getNetworkFeatureUid(t))).toArray():[t.uid];const i=r.filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.isSome);return i.length?(this._addHighlight(i),{remove:()=>this._removeHighlight(i)}):y}async hitTest(t,r){if(this.suspended)return null;const i=this._graphicsView.hitTest(t).filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.isSome).map((t=>this._networkGraphicMap.get(t)));if(!i.length)return null;const{layer:s}=this;return i.reverse().map((e=>({type:"route",layer:s,mapPoint:t,networkFeature:e})))}isUpdating(){return this._graphicsView.updating}moveStart(){}moveEnd(){}update(t){this._graphicsView.processUpdate(t)}viewChange(){this._graphicsView.viewChange()}_addHighlight(t){for(const e of t)if(this._highlightIds.has(e)){const t=this._highlightIds.get(e);this._highlightIds.set(e,t+1)}else this._highlightIds.set(e,1);this._updateHighlight()}_createGraphic(t){const e=t.toGraphic();return e.layer=this.layer,e.sourceLayer=this.layer,e}_createGraphicsView(){const t=this.view,e=()=>this.requestUpdate(),r=new _graphics_GraphicContainer_js__WEBPACK_IMPORTED_MODULE_17__["default"](t.featuresTilingScheme);this._graphicsView=new _graphics_GraphicsView2D_js__WEBPACK_IMPORTED_MODULE_18__["default"]({container:r,graphics:this._graphics,requestUpdateCallback:e,view:t}),this.container.addChild(r),this._updateHighlight()}_destroyGraphicsView(){this.container.removeChild(this._graphicsView.container),this._graphicsView.destroy()}_getDrawOrder(t){const e=this._networkGraphicMap.get(t);return k.indexOf(e.type)}_getNetworkFeatureUid(t){return this._networkFeatureMap.has(t)?this._networkFeatureMap.get(t).uid:null}_removeHighlight(t){for(const e of t)if(this._highlightIds.has(e)){const t=this._highlightIds.get(e)-1;0===t?this._highlightIds.delete(e):this._highlightIds.set(e,t)}this._updateHighlight()}_routeItemsChanged(t){if(t.removed.length){this._graphics.removeMany(t.removed.map((t=>{const e=this._networkFeatureMap.get(t);return this._networkFeatureMap.delete(t),this._networkGraphicMap.delete(e),e})));for(const e of t.removed)this.removeHandles(e)}if(t.added.length){this._graphics.addMany(t.added.map((t=>{const e=this._createGraphic(t);return null==e.symbol?null:(this._networkFeatureMap.set(t,e),this._networkGraphicMap.set(e,t),e)})).filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.isSome));for(const e of t.added)this.addHandles([(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__.watch)((()=>e.geometry),((t,r)=>{this._updateGraphic(e,"geometry",t,r)})),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__.watch)((()=>e.symbol),((t,r)=>{this._updateGraphic(e,"symbol",t,r)}))],e);this._graphics.sort(((t,e)=>this._getDrawOrder(t)-this._getDrawOrder(e)))}}_updateGraphic(t,e,r,i){if(!this._networkFeatureMap.has(t)){const e=this._createGraphic(t);return this._networkFeatureMap.set(t,e),this._networkGraphicMap.set(e,t),void this._graphics.add(e)}const s=this._networkFeatureMap.get(t);s[e]=r,v.graphic=s,v.property=e,v.oldValue=i,v.newValue=r,this._graphicsView.graphicUpdateHandler(v)}_updateHighlight(){const t=Array.from(this._highlightIds.keys());this._graphicsView.setHighlight(t)}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__.property)()],G.prototype,"_graphics",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__.property)()],G.prototype,"_routeItems",null),G=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__.subclass)("esri.views.2d.layers.RouteLayerView2D")],G);const I=G;


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicContainer.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicContainer.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ i)
/* harmony export */ });
/* harmony import */ var _engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../engine/webgl/enums.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/enums.js");
/* harmony import */ var _BaseGraphicContainer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseGraphicContainer.js */ "./node_modules/@arcgis/core/views/2d/layers/graphics/BaseGraphicContainer.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
class i extends _BaseGraphicContainer_js__WEBPACK_IMPORTED_MODULE_1__["default"]{renderChildren(r){this.attributeView.update(),this.children.some((e=>e.hasData))&&(this.attributeView.bindTextures(r.context,!1),super.renderChildren(r),r.drawPhase===_engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__.WGLDrawPhase.MAP&&this._renderChildren(r),this.hasHighlight()&&r.drawPhase===_engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(r),this._boundsRenderer&&this._boundsRenderer.doRender(r))}_renderHighlight(e){const{painter:r}=e,i=r.effects.highlight;i.bind(e),this._renderChildren(e,i.defines),i.draw(e),i.unbind()}}


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvMzE5ZTk3MzA0NTE3YjFjMWUzZGQzN2M4MWZiN2Y4NDIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDaWlDLHVCQUF1QixVQUFVLFVBQVUsWUFBWSxxSEFBcUgsd0RBQXdELGNBQWMsb0JBQW9CLHNFQUFDLGVBQWUsd0VBQUMsZUFBZSxzRUFBQyxlQUFlLHdFQUFDLGVBQWUseUVBQUMsZUFBZSxtRUFBQyxlQUFlLDhEQUFDLENBQUMsY0FBYyxPQUFPLHdFQUFjLDBCQUEwQixjQUFjLDZDQUE2QyxvQkFBb0Isa0VBQUMsQ0FBQyw2REFBQyxHQUFHLGNBQWMsdUNBQXVDLDJEQUFDLDRGQUE0RixrQkFBa0IsV0FBVyxvRUFBQyxFQUFFLHVGQUF1RiwyREFBQyxxTEFBcUwsRUFBRSxhQUFhLGtHQUFrRywyREFBQyxFQUFFLFVBQVUsK0hBQStILFNBQVMsMkJBQTJCLFNBQVMsNEJBQTRCLDRCQUE0QixvRUFBb0UsYUFBYSxNQUFNLHVKQUF1SixpQkFBaUIsdURBQUMsRUFBRSx3Q0FBd0Msb0NBQW9DLElBQUksbUJBQW1CLDhCQUE4Qiw2Q0FBNkMsdURBQUMsMkNBQTJDLHlCQUF5QixNQUFNLFFBQVEsTUFBTSw2QkFBNkIsaURBQWlELElBQUksYUFBYSxtQ0FBbUMsYUFBYSxXQUFXLFVBQVUsb0NBQW9DLGFBQWEsZ0NBQWdDLGlCQUFpQiwrQ0FBK0Msa0NBQWtDLDhCQUE4QixpQ0FBaUMsd0JBQXdCLGtCQUFrQixzQkFBc0IscURBQXFELHNCQUFzQixtREFBbUQsc0VBQUMseUJBQXlCLHVCQUF1QixvRUFBQyxFQUFFLG1FQUFtRSxxREFBcUQsdUJBQXVCLHNGQUFzRixpQkFBaUIsdUNBQXVDLHlCQUF5Qix5QkFBeUIsOEVBQThFLG9CQUFvQiwrQ0FBK0Msb0NBQW9DLCtEQUErRCx3QkFBd0Isc0JBQXNCLHFCQUFxQiw2Q0FBNkMsdUNBQXVDLDZFQUE2RSxJQUFJLCtDQUErQyxtQkFBbUIsd0NBQXdDLCtCQUErQixpR0FBaUcsVUFBVSx1REFBQyxHQUFHLHdDQUF3Qyw2REFBQywyQkFBMkIsc0NBQXNDLEdBQUcsNkRBQUMseUJBQXlCLG9DQUFvQyxPQUFPLDJFQUEyRSx3QkFBd0Isb0NBQW9DLCtCQUErQixvR0FBb0csdUNBQXVDLHFHQUFxRyxtQkFBbUIsOENBQThDLHFDQUFxQyx1REFBQyxFQUFFLHNGQUFDLG9DQUFvQyx1REFBQyxFQUFFLHNGQUFDLHNDQUFzQyx1REFBQyxFQUFFLHNGQUFDLDhDQUE4QyxVQUErQjs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNKajBLO0FBQ0E7QUFDQTtBQUNBO0FBQ29HLGdCQUFnQixnRUFBQyxDQUFDLGtCQUFrQixxSkFBcUosb0VBQUssNkRBQTZELDBFQUFXLG1GQUFtRixvQkFBb0IsTUFBTSxVQUFVLHlCQUF5QixrRUFBdUYiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvY29yZS92aWV3cy8yZC9sYXllcnMvUm91dGVMYXllclZpZXcyRC5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvY29yZS92aWV3cy8yZC9sYXllcnMvZ3JhcGhpY3MvR3JhcGhpY0NvbnRhaW5lci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cblNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4yNy9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4qL1xuaW1wb3J0e18gYXMgdH1mcm9tXCIuLi8uLi8uLi9jaHVua3MvdHNsaWIuZXM2LmpzXCI7aW1wb3J0e2lzU29tZSBhcyBlfWZyb21cIi4uLy4uLy4uL2NvcmUvYXJyYXlVdGlscy5qc1wiO2ltcG9ydCByIGZyb21cIi4uLy4uLy4uL2NvcmUvQ29sbGVjdGlvbi5qc1wiO2ltcG9ydCBpIGZyb21cIi4uLy4uLy4uL2NvcmUvQ29sbGVjdGlvbkZsYXR0ZW5lci5qc1wiO2ltcG9ydHtpbml0aWFsIGFzIHMsd2F0Y2ggYXMgb31mcm9tXCIuLi8uLi8uLi9jb3JlL3JlYWN0aXZlVXRpbHMuanNcIjtpbXBvcnR7cHJvcGVydHkgYXMgYX1mcm9tXCIuLi8uLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9kZWNvcmF0b3JzL3Byb3BlcnR5LmpzXCI7aW1wb3J0XCIuLi8uLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9lbnN1cmVUeXBlLmpzXCI7aW1wb3J0XCIuLi8uLi8uLi9jb3JlL2hhcy5qc1wiO2ltcG9ydHtzdWJjbGFzcyBhcyBofWZyb21cIi4uLy4uLy4uL2NvcmUvYWNjZXNzb3JTdXBwb3J0L2RlY29yYXRvcnMvc3ViY2xhc3MuanNcIjtpbXBvcnQgbiBmcm9tXCIuLi8uLi8uLi9yZXN0L3N1cHBvcnQvRGlyZWN0aW9uTGluZS5qc1wiO2ltcG9ydCBwIGZyb21cIi4uLy4uLy4uL3Jlc3Qvc3VwcG9ydC9EaXJlY3Rpb25Qb2ludC5qc1wiO2ltcG9ydCBsIGZyb21cIi4uLy4uLy4uL3Jlc3Qvc3VwcG9ydC9Qb2ludEJhcnJpZXIuanNcIjtpbXBvcnQgYyBmcm9tXCIuLi8uLi8uLi9yZXN0L3N1cHBvcnQvUG9seWdvbkJhcnJpZXIuanNcIjtpbXBvcnQgZyBmcm9tXCIuLi8uLi8uLi9yZXN0L3N1cHBvcnQvUG9seWxpbmVCYXJyaWVyLmpzXCI7aW1wb3J0IHUgZnJvbVwiLi4vLi4vLi4vcmVzdC9zdXBwb3J0L1JvdXRlSW5mby5qc1wiO2ltcG9ydCBkIGZyb21cIi4uLy4uLy4uL3Jlc3Qvc3VwcG9ydC9TdG9wLmpzXCI7aW1wb3J0e0xheWVyVmlldzJETWl4aW4gYXMgX31mcm9tXCIuL0xheWVyVmlldzJELmpzXCI7aW1wb3J0IG0gZnJvbVwiLi9ncmFwaGljcy9HcmFwaGljQ29udGFpbmVyLmpzXCI7aW1wb3J0IHcgZnJvbVwiLi9ncmFwaGljcy9HcmFwaGljc1ZpZXcyRC5qc1wiO2ltcG9ydCBmIGZyb21cIi4uLy4uL2xheWVycy9MYXllclZpZXcuanNcIjtjb25zdCB5PU9iamVjdC5mcmVlemUoe3JlbW92ZSgpe30scGF1c2UoKXt9LHJlc3VtZSgpe319KSxrPVtcInJvdXRlLWluZm9cIixcImRpcmVjdGlvbi1saW5lXCIsXCJkaXJlY3Rpb24tcG9pbnRcIixcInBvbHlnb24tYmFycmllclwiLFwicG9seWxpbmUtYmFycmllclwiLFwicG9pbnQtYmFycmllclwiLFwic3RvcFwiXSx2PXtncmFwaGljOm51bGwscHJvcGVydHk6bnVsbCxvbGRWYWx1ZTpudWxsLG5ld1ZhbHVlOm51bGx9O2Z1bmN0aW9uIE0odCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBufHx0IGluc3RhbmNlb2YgcHx8dCBpbnN0YW5jZW9mIGx8fHQgaW5zdGFuY2VvZiBjfHx0IGluc3RhbmNlb2YgZ3x8dCBpbnN0YW5jZW9mIHV8fHQgaW5zdGFuY2VvZiBkfWZ1bmN0aW9uIFYodCl7cmV0dXJuIHIuaXNDb2xsZWN0aW9uKHQpJiZ0Lmxlbmd0aCYmTSh0LmF0KDApKX1mdW5jdGlvbiBqKHQpe3JldHVybiBBcnJheS5pc0FycmF5KHQpJiZ0Lmxlbmd0aD4wJiZNKHRbMF0pfWxldCBHPWNsYXNzIGV4dGVuZHMoXyhmKSl7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMuX2dyYXBoaWNzPW5ldyByLHRoaXMuX2hpZ2hsaWdodElkcz1uZXcgTWFwLHRoaXMuX25ldHdvcmtGZWF0dXJlTWFwPW5ldyBNYXAsdGhpcy5fbmV0d29ya0dyYXBoaWNNYXA9bmV3IE1hcH1nZXQgX3JvdXRlSXRlbXMoKXtyZXR1cm4gbmV3IGkoe2dldENvbGxlY3Rpb25zOigpPT5udWxsPT10aGlzLmxheWVyfHx0aGlzLmRlc3Ryb3llZD9bXTpbbnVsbCE9dGhpcy5sYXllci5yb3V0ZUluZm8/bmV3IHIoW3RoaXMubGF5ZXIucm91dGVJbmZvXSk6bnVsbCx0aGlzLmxheWVyLmRpcmVjdGlvbkxpbmVzLHRoaXMubGF5ZXIuZGlyZWN0aW9uUG9pbnRzLHRoaXMubGF5ZXIucG9seWdvbkJhcnJpZXJzLHRoaXMubGF5ZXIucG9seWxpbmVCYXJyaWVycyx0aGlzLmxheWVyLnBvaW50QmFycmllcnMsdGhpcy5sYXllci5zdG9wc119KX1pbml0aWFsaXplKCl7dGhpcy51cGRhdGluZ0hhbmRsZXMuYWRkT25Db2xsZWN0aW9uQ2hhbmdlKCgoKT0+dGhpcy5fcm91dGVJdGVtcyksKHQ9PnRoaXMuX3JvdXRlSXRlbXNDaGFuZ2VkKHQpKSxzKX1kZXN0cm95KCl7dGhpcy5fbmV0d29ya0ZlYXR1cmVNYXAuY2xlYXIoKSx0aGlzLl9uZXR3b3JrR3JhcGhpY01hcC5jbGVhcigpLHRoaXMuX2dyYXBoaWNzLnJlbW92ZUFsbCgpLHRoaXMuX2dldChcIl9yb3V0ZUl0ZW1zXCIpPy5kZXN0cm95KCl9YXR0YWNoKCl7dGhpcy5fY3JlYXRlR3JhcGhpY3NWaWV3KCl9ZGV0YWNoKCl7dGhpcy5fZGVzdHJveUdyYXBoaWNzVmlldygpfWFzeW5jIGZldGNoUG9wdXBGZWF0dXJlcyh0KXtyZXR1cm4gdGhpcy5fZ3JhcGhpY3NWaWV3LmhpdFRlc3QodCkuZmlsdGVyKCh0PT4hIXQucG9wdXBUZW1wbGF0ZSkpfWhpZ2hsaWdodCh0KXtsZXQgcjtyPU0odCk/W3RoaXMuX2dldE5ldHdvcmtGZWF0dXJlVWlkKHQpXTpqKHQpP3QubWFwKCh0PT50aGlzLl9nZXROZXR3b3JrRmVhdHVyZVVpZCh0KSkpOlYodCk/dC5tYXAoKHQ9PnRoaXMuX2dldE5ldHdvcmtGZWF0dXJlVWlkKHQpKSkudG9BcnJheSgpOlt0LnVpZF07Y29uc3QgaT1yLmZpbHRlcihlKTtyZXR1cm4gaS5sZW5ndGg/KHRoaXMuX2FkZEhpZ2hsaWdodChpKSx7cmVtb3ZlOigpPT50aGlzLl9yZW1vdmVIaWdobGlnaHQoaSl9KTp5fWFzeW5jIGhpdFRlc3QodCxyKXtpZih0aGlzLnN1c3BlbmRlZClyZXR1cm4gbnVsbDtjb25zdCBpPXRoaXMuX2dyYXBoaWNzVmlldy5oaXRUZXN0KHQpLmZpbHRlcihlKS5tYXAoKHQ9PnRoaXMuX25ldHdvcmtHcmFwaGljTWFwLmdldCh0KSkpO2lmKCFpLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdHtsYXllcjpzfT10aGlzO3JldHVybiBpLnJldmVyc2UoKS5tYXAoKGU9Pih7dHlwZTpcInJvdXRlXCIsbGF5ZXI6cyxtYXBQb2ludDp0LG5ldHdvcmtGZWF0dXJlOmV9KSkpfWlzVXBkYXRpbmcoKXtyZXR1cm4gdGhpcy5fZ3JhcGhpY3NWaWV3LnVwZGF0aW5nfW1vdmVTdGFydCgpe31tb3ZlRW5kKCl7fXVwZGF0ZSh0KXt0aGlzLl9ncmFwaGljc1ZpZXcucHJvY2Vzc1VwZGF0ZSh0KX12aWV3Q2hhbmdlKCl7dGhpcy5fZ3JhcGhpY3NWaWV3LnZpZXdDaGFuZ2UoKX1fYWRkSGlnaGxpZ2h0KHQpe2Zvcihjb25zdCBlIG9mIHQpaWYodGhpcy5faGlnaGxpZ2h0SWRzLmhhcyhlKSl7Y29uc3QgdD10aGlzLl9oaWdobGlnaHRJZHMuZ2V0KGUpO3RoaXMuX2hpZ2hsaWdodElkcy5zZXQoZSx0KzEpfWVsc2UgdGhpcy5faGlnaGxpZ2h0SWRzLnNldChlLDEpO3RoaXMuX3VwZGF0ZUhpZ2hsaWdodCgpfV9jcmVhdGVHcmFwaGljKHQpe2NvbnN0IGU9dC50b0dyYXBoaWMoKTtyZXR1cm4gZS5sYXllcj10aGlzLmxheWVyLGUuc291cmNlTGF5ZXI9dGhpcy5sYXllcixlfV9jcmVhdGVHcmFwaGljc1ZpZXcoKXtjb25zdCB0PXRoaXMudmlldyxlPSgpPT50aGlzLnJlcXVlc3RVcGRhdGUoKSxyPW5ldyBtKHQuZmVhdHVyZXNUaWxpbmdTY2hlbWUpO3RoaXMuX2dyYXBoaWNzVmlldz1uZXcgdyh7Y29udGFpbmVyOnIsZ3JhcGhpY3M6dGhpcy5fZ3JhcGhpY3MscmVxdWVzdFVwZGF0ZUNhbGxiYWNrOmUsdmlldzp0fSksdGhpcy5jb250YWluZXIuYWRkQ2hpbGQociksdGhpcy5fdXBkYXRlSGlnaGxpZ2h0KCl9X2Rlc3Ryb3lHcmFwaGljc1ZpZXcoKXt0aGlzLmNvbnRhaW5lci5yZW1vdmVDaGlsZCh0aGlzLl9ncmFwaGljc1ZpZXcuY29udGFpbmVyKSx0aGlzLl9ncmFwaGljc1ZpZXcuZGVzdHJveSgpfV9nZXREcmF3T3JkZXIodCl7Y29uc3QgZT10aGlzLl9uZXR3b3JrR3JhcGhpY01hcC5nZXQodCk7cmV0dXJuIGsuaW5kZXhPZihlLnR5cGUpfV9nZXROZXR3b3JrRmVhdHVyZVVpZCh0KXtyZXR1cm4gdGhpcy5fbmV0d29ya0ZlYXR1cmVNYXAuaGFzKHQpP3RoaXMuX25ldHdvcmtGZWF0dXJlTWFwLmdldCh0KS51aWQ6bnVsbH1fcmVtb3ZlSGlnaGxpZ2h0KHQpe2Zvcihjb25zdCBlIG9mIHQpaWYodGhpcy5faGlnaGxpZ2h0SWRzLmhhcyhlKSl7Y29uc3QgdD10aGlzLl9oaWdobGlnaHRJZHMuZ2V0KGUpLTE7MD09PXQ/dGhpcy5faGlnaGxpZ2h0SWRzLmRlbGV0ZShlKTp0aGlzLl9oaWdobGlnaHRJZHMuc2V0KGUsdCl9dGhpcy5fdXBkYXRlSGlnaGxpZ2h0KCl9X3JvdXRlSXRlbXNDaGFuZ2VkKHQpe2lmKHQucmVtb3ZlZC5sZW5ndGgpe3RoaXMuX2dyYXBoaWNzLnJlbW92ZU1hbnkodC5yZW1vdmVkLm1hcCgodD0+e2NvbnN0IGU9dGhpcy5fbmV0d29ya0ZlYXR1cmVNYXAuZ2V0KHQpO3JldHVybiB0aGlzLl9uZXR3b3JrRmVhdHVyZU1hcC5kZWxldGUodCksdGhpcy5fbmV0d29ya0dyYXBoaWNNYXAuZGVsZXRlKGUpLGV9KSkpO2Zvcihjb25zdCBlIG9mIHQucmVtb3ZlZCl0aGlzLnJlbW92ZUhhbmRsZXMoZSl9aWYodC5hZGRlZC5sZW5ndGgpe3RoaXMuX2dyYXBoaWNzLmFkZE1hbnkodC5hZGRlZC5tYXAoKHQ9Pntjb25zdCBlPXRoaXMuX2NyZWF0ZUdyYXBoaWModCk7cmV0dXJuIG51bGw9PWUuc3ltYm9sP251bGw6KHRoaXMuX25ldHdvcmtGZWF0dXJlTWFwLnNldCh0LGUpLHRoaXMuX25ldHdvcmtHcmFwaGljTWFwLnNldChlLHQpLGUpfSkpLmZpbHRlcihlKSk7Zm9yKGNvbnN0IGUgb2YgdC5hZGRlZCl0aGlzLmFkZEhhbmRsZXMoW28oKCgpPT5lLmdlb21ldHJ5KSwoKHQscik9Pnt0aGlzLl91cGRhdGVHcmFwaGljKGUsXCJnZW9tZXRyeVwiLHQscil9KSksbygoKCk9PmUuc3ltYm9sKSwoKHQscik9Pnt0aGlzLl91cGRhdGVHcmFwaGljKGUsXCJzeW1ib2xcIix0LHIpfSkpXSxlKTt0aGlzLl9ncmFwaGljcy5zb3J0KCgodCxlKT0+dGhpcy5fZ2V0RHJhd09yZGVyKHQpLXRoaXMuX2dldERyYXdPcmRlcihlKSkpfX1fdXBkYXRlR3JhcGhpYyh0LGUscixpKXtpZighdGhpcy5fbmV0d29ya0ZlYXR1cmVNYXAuaGFzKHQpKXtjb25zdCBlPXRoaXMuX2NyZWF0ZUdyYXBoaWModCk7cmV0dXJuIHRoaXMuX25ldHdvcmtGZWF0dXJlTWFwLnNldCh0LGUpLHRoaXMuX25ldHdvcmtHcmFwaGljTWFwLnNldChlLHQpLHZvaWQgdGhpcy5fZ3JhcGhpY3MuYWRkKGUpfWNvbnN0IHM9dGhpcy5fbmV0d29ya0ZlYXR1cmVNYXAuZ2V0KHQpO3NbZV09cix2LmdyYXBoaWM9cyx2LnByb3BlcnR5PWUsdi5vbGRWYWx1ZT1pLHYubmV3VmFsdWU9cix0aGlzLl9ncmFwaGljc1ZpZXcuZ3JhcGhpY1VwZGF0ZUhhbmRsZXIodil9X3VwZGF0ZUhpZ2hsaWdodCgpe2NvbnN0IHQ9QXJyYXkuZnJvbSh0aGlzLl9oaWdobGlnaHRJZHMua2V5cygpKTt0aGlzLl9ncmFwaGljc1ZpZXcuc2V0SGlnaGxpZ2h0KHQpfX07dChbYSgpXSxHLnByb3RvdHlwZSxcIl9ncmFwaGljc1wiLHZvaWQgMCksdChbYSgpXSxHLnByb3RvdHlwZSxcIl9yb3V0ZUl0ZW1zXCIsbnVsbCksRz10KFtoKFwiZXNyaS52aWV3cy4yZC5sYXllcnMuUm91dGVMYXllclZpZXcyRFwiKV0sRyk7Y29uc3QgST1HO2V4cG9ydHtJIGFzIGRlZmF1bHR9O1xuIiwiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjcvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydHtXR0xEcmF3UGhhc2UgYXMgZX1mcm9tXCIuLi8uLi9lbmdpbmUvd2ViZ2wvZW51bXMuanNcIjtpbXBvcnQgciBmcm9tXCIuL0Jhc2VHcmFwaGljQ29udGFpbmVyLmpzXCI7Y2xhc3MgaSBleHRlbmRzIHJ7cmVuZGVyQ2hpbGRyZW4ocil7dGhpcy5hdHRyaWJ1dGVWaWV3LnVwZGF0ZSgpLHRoaXMuY2hpbGRyZW4uc29tZSgoZT0+ZS5oYXNEYXRhKSkmJih0aGlzLmF0dHJpYnV0ZVZpZXcuYmluZFRleHR1cmVzKHIuY29udGV4dCwhMSksc3VwZXIucmVuZGVyQ2hpbGRyZW4ociksci5kcmF3UGhhc2U9PT1lLk1BUCYmdGhpcy5fcmVuZGVyQ2hpbGRyZW4ociksdGhpcy5oYXNIaWdobGlnaHQoKSYmci5kcmF3UGhhc2U9PT1lLkhJR0hMSUdIVCYmdGhpcy5fcmVuZGVySGlnaGxpZ2h0KHIpLHRoaXMuX2JvdW5kc1JlbmRlcmVyJiZ0aGlzLl9ib3VuZHNSZW5kZXJlci5kb1JlbmRlcihyKSl9X3JlbmRlckhpZ2hsaWdodChlKXtjb25zdHtwYWludGVyOnJ9PWUsaT1yLmVmZmVjdHMuaGlnaGxpZ2h0O2kuYmluZChlKSx0aGlzLl9yZW5kZXJDaGlsZHJlbihlLGkuZGVmaW5lcyksaS5kcmF3KGUpLGkudW5iaW5kKCl9fWV4cG9ydHtpIGFzIGRlZmF1bHR9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9